<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
{% extends 'base.html' %}


{% block content %}
<style>
	/*
	Common invoice styles. These styles will work in a browser or using the HTML
	to PDF anvil endpoint.
*/
#removeButton {
    margin-top: 10px; /* Adjust as necessary for your layout */
    padding: .25rem .80rem; /* Similar padding to bootstrap's btn class */
    border-radius: .25rem; /* Rounded borders */
    border: 1px solid #ced4da; /* Similar to default file input button */
    cursor: pointer; /* Pointer cursor on hover */
    font-size: 0.9rem; /* Adjust font size as needed */
    line-height: 0.9; /* For proper text alignment */
    transition: color .15s ease-in-out, background-color .15s ease-in-out, border-color .15s ease-in-out, box-shadow .15s ease-in-out; /* Smooth transition for hover effects */
}
.general-information-table {
  table-layout: fixed;
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}
td {
  word-wrap: break-word; /* Allows long words to be able to break and wrap onto the next line */
  white-space: normal; /* Allows whitespace to behave normally, i.e., wrapping the text */
}
.general-information-table td {
    padding: 8px;
    vertical-align: middle;
	
}

.general-information-table input[type="text"], 
.general-information-table input[type="date"] {
    width: 100%;
    padding: 6px;
    border-radius: 4px;
    border: 1px solid #ccc;
    box-sizing: border-box; /* Include padding in width */
	text-align: left;
}

.general-information-table tr:nth-child(even) {
    background-color: #f2f2f2; /* Zebra striping for rows */
}

.general-information-table td:nth-child(1) {
    text-align: left;
    width: 25%;
}

.general-information-table td:nth-child(2) {
    width: 25%;
}

.general-information-table td:nth-child(3), 
.general-information-table td:nth-child(4) {
    text-align: right;
    width: 25%;
}
	.line-items-container {
  table-layout: fixed;
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

.line-items-container, .line-items-container th, .line-items-container td {
  border: 1px solid #ddd;
  text-align: center;
  padding: 8px;
}

.line-items-container th {
  background-color: #999;
  color: white;
  text-align: center;
}

.line-items-container select,
.line-items-container input {
    width: 100%; /* Will fill the cell */
    box-sizing: border-box; /* Include padding and border in the width */
}
@media screen and (max-width: 600px) {
  .line-items-container, .line-items-container thead, .line-items-container tbody, .line-items-container th, .line-items-container td, .line-items-container tr {
    text-align: center;
	display: block;
  }

  .line-items-container thead tr {
    text-align: j;
    top: -9999px;
    left: -9999px;
  }

  .line-items-container tr {
    margin: 0 0 1rem 0;
  }

  .line-items-container td {
    border: none;
    position: relative;
    padding-left: 50%;
  }

  .line-items-container td:before {
    position: absolute;
    top: 6px;
    left: 6px;
    width: 45%;
    padding-right: 10px;
    white-space: nowrap;
    content: attr(name);
  }
}

	.payment-info {
		width: 38%;
		font-size: 0.75em;
		line-height: 1.5;
	}

	.footer {
		margin-top: 100px;
	}


	.footer-info {
		float: right;
		margin-top: 5px;
		font-size: 0.75em;
		color: #ccc;
	}

	.footer-info span {
		padding: 0 5px;
		color: black;
	}

	.add-new-button {
		background-color: white;
		border: 2px solid #008CBA;
	}

	.add-new-button:hover {
		background-color: #008CBA;
		color: white;
	}

	.payment-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

.payment-table, .payment-table th, .payment-table td {
  border: 1px solid #ddd;
  text-align: left;
  padding: 8px;
}

.payment-table th {
  background-color: #999;
  color: white;
}

.payment-table td input[type="text"], .payment-table td select {
  width: 100%;
  padding: 5px;
  margin: 4px 0;
  box-sizing: border-box;
  border: 1px solid #ccc;
  border-radius: 4px;
}


@media screen and (max-width: 600px) {
  .payment-table, .payment-table thead, .payment-table tbody, .payment-table th, .payment-table td, .payment-table tr {
    display: block;
  }

  .payment-table thead tr {
    position: absolute;
    top: -9999px;
    left: -9999px;
  }

  .payment-table tr {
    margin: 0 0 1rem 0;
  }

  .payment-table td {
    border: none;
    position: relative;
    padding-left: 50%;
  }

  .payment-table td:before {
    position: absolute;
    top: 6px;
    left: 6px;
    width: 45%;
    padding-right: 10px;
    white-space: nowrap;
  }

  .payment-table td:nth-of-type(1):before { content: "PAYMENT"; }
  .payment-table td:nth-of-type(2):before { content: "PERCENTAGE"; }
  .payment-table td:nth-of-type(3):before { content: "AMOUNT"; }
  .payment-table td:nth-of-type(4):before { content: "REMARKS"; }
}



</style>

<form id="workOrder" , method="post" enctype="multipart/form-data">
	{%csrf_token%}
	{% if error %}
    <div class="alert alert-danger" role="alert">
        {{ error }}
    </div>
{% endif %}
<div style="text-align: center; background-color: white">
    {% if order.company == 'aci' %}
        <img src="{{ MEDIA_URL }}aci_cmp_logo3.jpg" style="width: 400px;">
		<input type="hidden" value="aci"  name ="company" id ="company">
    {% elif order.company == 'bks' %}

        <img src="{{ MEDIA_URL }}bks4.png">
		<input type="hidden" value="bks"  name ="company" id ="company">
    {% else %}

    <img src="{{ MEDIA_URL }}lki_cmp_logo2.jpg" style="width: 400px;"> <!-- Same width for consistency -->
		<input type="hidden" value="lki"  name ="company" id ="company">
    {% endif %}
</div>
	<!-- Title Text -->

	<div style="text-align: center; font-size: 2.0em;">
		<b>
			{% if order.company == 'aci' %}
				PT. ANSINDA COMMUNICATION INDONESIA
        {% elif order.company == 'bks' %}
				PT. BAHTERA KONSTRUKSI SEJAHTERA
        {% else %}
				PT. LEONY KONSTRUKSKI INDONESIA
			{% endif %}
		</b>
	</div>
	<div style="text-align: center; font-size: 2.5em;">
		<b>WORK ORDER</b>
	</div>
	<table class = "general-information-table"  >
		<tr>
			<td style="width: 18%;">DATE</td>
			<td style="width: 2%; text-align: center;">:</td>
			<td style="width: 20%; text-align: left;" ><input type ="date" name="wo_date" id ="wo_date" type="date" style="text-align: left; height: 30px" value="{{ order.wo_date|date:'Y-m-d' }}"/></td>
			
			<td style ="width:10%"></td>

			<td style ="width:18%">WO NUMBER</td>
			<td style="width: 2%;">:</td>
			{% if order.company == 'aci' %}
				{%if order.project == 'EMR' %}
					<td style ="width:30%">WO / ACI / EMR / <input name ="shortdate"  value="{{order.shortdate}}" id ="shortdate" type ="text" style="width: 10%; height: 30px; text-align: center;" readonly> / <input name="wo_number" id = "wo_number" value="{{order.wo_number}}" type="number" style="text-align: right; height: 30px; width: 20%;" min = "0" max = "9999" maxlength="4"></td>
				{%else%}
				<td style ="width:30%">WO / ACI / LN / <input name ="shortdate"  value="{{order.shortdate}}" id ="shortdate" type ="text" style="width: 10%; height: 30px; text-align: center;" readonly> / <input name="wo_number" id = "wo_number" value="{{order.wo_number}}" type="number" style="text-align: right; height: 30px; width: 20%;" min = "0" max = "9999" maxlength="4"></td>
				{%endif%}

			{% elif order.company == 'bks' %}
				{%if order.project == 'EMR' %}
				<td style ="width:30%">WO / BKS / EMR / <input name ="shortdate" id ="shortdate"  value="{{order.shortdate}}" type ="text" style="width: 10%; height: 30px; text-align: center;" readonly> / <input name="wo_number" id = "wo_number" value="{{order.wo_number}}"	 type="number" style="text-align: right; height: 30px; width: 20%;" min = "0" max = "9999" maxlength="4"></td>
				{%else%}
				<td style ="width:30%">WO / BKS / LN / <input name ="shortdate" id ="shortdate"  value="{{order.shortdate}}" type ="text" style="width: 10%; height: 30px; text-align: center;" readonly> / <input name="wo_number" id = "wo_number" value="{{order.wo_number}}"	 type="number" style="text-align: right; height: 30px; width: 20%;" min = "0" max = "9999" maxlength="4"></td>
				{%endif%}
			
			{% else %}
				{%if order.project == 'EMR' %}
					<td style ="width:30%">WO / LKI / EMR / <input name ="shortdate" id ="shortdate"  value="{{order.shortdate}}" type ="text" style="width: 10%; height: 30px; text-align: center;" readonly> / <input name="wo_number" id = "wo_number" value="{{order.wo_number}}"	 type="number" style="text-align: right; height: 30px; width: 20%;" min = "0" max = "9999" maxlength="4"></td>
				{%else%}
					<td style ="width:30%">WO / LKI / LN / <input name ="shortdate" id ="shortdate"  value="{{order.shortdate}}" type ="text" style="width: 10%; height: 30px; text-align: center;" readonly> / <input name="wo_number" id = "wo_number" value="{{order.wo_number}}"	 type="number" style="text-align: right; height: 30px; width: 20%;" min = "0" max = "9999" maxlength="4"></td>
				{%endif%}
			{% endif %}				
		</tr>
		<tr>
			<td style="width: 18%;">REQUEST BY</td>
			<td style="width: 2%; text-align: center;">:</td>
			<td style="width: 20%; text-align: left;"><input text-transform: uppercase; value="{{order.request_by}}" name="request_by" type="text" style="text-align: left; height: 30px;"></td >
			<td style ="width:20%">
				
			<td>CATEGORY</td>
			<td style="width: 2%;">:</td>
			<td style ="width:20%"><input value="{{order.category}}" name="category" type="text" style="text-align: left; height: 30px; display: none;" >{{order.category}}</td>
		</tr>
		<tr>
			<td style="text-align: left; width: 25px;">PROJECT</td>
			<td>:</td>
			{% if order.project == "EMR" %}
			<td style="text-align: left;"><input name="project" type="text" style=" height : 30px ; display: none;" value="EMR"> </strong> EMR</td>
			{% else %}
			<td style="text-align: left;"><input name="project" type="text" style=" height : 30px ; display: none;" value="LN"> </strong> LN</td>
			{%endif%}			<td></td>

			<td>BANK</td>
			<td>:</td>
		{% if order.bank != 'BCA' and order.bank != 'MANDIRI' and order.bank != 'OCBC NISP' and order.bank != 'BRI' %}
			<td style="text-align: left;">
				<input value="{{order.bank}}" type="text" id ="bank" name ="bank">
			</td>
		{% else %}
			<td style="text-align: left;">
				<select id="bank" name="bank" style="text-align: left; height: 30px; width: 100%;">
					<option value="BCA" {% if order.bank == 'BCA' %}selected{% endif %}>BCA</option>
					<option value="MANDIRI" {% if order.bank == 'MANDIRI' %}selected{% endif %}>MANDIRI</option>
					<option value="OCBC NISP" {% if order.bank == 'OCBC NISP' %}selected{% endif %}>OCBC</option>
					<option value="BRI" {% if order.bank == 'BRI' %}selected{% endif %}>BRI</option>
					<option value="CREATE">CREATE</option>
				</select>
			</td>
		{% endif %}
		</tr>
		<tr>
			<td style="text-align: left;">CUSTOMER</td>
			<td>:</td>
			{% if order.customer != 'ZTE' and order.customer != 'YOFC' and order.customer != 'OCBC FH'%}
			<td style="text-align: left;">
				<input value="{{order.customer}}" type="text" id ="customer" name ="customer">
			</td>
			{% else %}
			<td style="text-align: left;">
				<select id ="customer"name="customer" style="height : 30px ; width:100%;">
					<option value = "ZTE"  {% if order.customer == 'ZTE' %}selected{% endif %}>ZTE</option>
					<option value = "YOFC"  {% if order.customer == 'YOFC' %}selected{% endif %}>YOFC</option>
					<option value = "FH"  {% if order.customer == 'FH' %}selected{% endif %}>FH</option>
					<option value="CREATE">CREATE</option>
			</td>
			{%endif%}
			<td></td>

			<td style="text-align: left;height: 30px;">ACCOUNT NAME</td>
			<td>:</td>
			<td style="text-align: left;"><input value="{{order.account_name}}" name="account_name" type="text" style="height : 30px ;"></td>
		</tr>
		<tr>
			<td style="text-align: left; width: 25px;">DEPARTMENT</td>
			<td>:</td>
			<td style="text-align: left;"><input value="{{order.department}}" name="department" type="text" style=" height : 30px" value="PROJECT"></td>

			<td></td>

			<td style="text-align: left">ACCOUNT NUMBER</td>
			<td>:</td>
			<td style="text-align: left;"><input value="{{order.account_number}}" name="account_number" type="text" style="height : 30px"></td>
		</tr>
		<tr>
			<td style="text-align: left; width: 25px;">REGION</td>
			<td>:</td>
			{% if order.region != 'JABO' and order.region != 'CJ' and order.region != 'EJ' and order.region != 'WJ'%}
			<td style="text-align: left;">
				<input value="{{order.region}}" type="text" id ="region" name ="region">
			</td>
			{%else%}
			<td style="text-align: left;"><select id ="region" name="region" style=" height : 30px ;width: 100% ;">
				<option value="JABO"  {% if order.region == 'JABO' %}selected{% endif %}>JABO</option>
				<option value="CJ"  {% if order.region == 'CJ' %}selected{% endif %}>CJ</option>
				<option value="EJ"  {% if order.region == 'EJ' %}selected{% endif %}>EJ</option>
				<option value="WJ"  {% if order.region == 'WJ' %}selected{% endif %}>WJ</option>
				<option value="CREATE">CREATE</option>

			</td>
			{%endif%}
			<td></td>

			<td style="text-align: left">PHONE NUMBER</td>
			<td>:</td>
			<td style="text-align: left;"><input value="{{order.phone_number}}" name="phone_number" type="text" style="height : 30px"></td>
		</tr>
		<tr>
			<td style="text-align: left; width: 25px;">CITY</td>
			<td>:</td>
			<td style="text-align: left;"><input value="{{order.city}}" name="city" type="text" style=" height : 30px"></td>

			<td></td>

			<td style="text-align: left">KTP / NPWP</td>
			<td>:</td>
			<td style="text-align: left;"><input value="{{order.npwp}}" name="npwp" type="text" style="height : 30px"></td>
		</tr>
	</table>

    {%if order.project == 'EMR'%}
	<div class="table-container">
		<table class="line-items-container">
			<thead>
				<tr>
					<th class="heading-description" style ="width : 20%" >CLUSTER NAME</th>
					<th class="heading-description" style ="width : 20%">SITE ID</th>
					<th class="heading-description" style ="width : 20%">TYPE</th>
					<th class="heading-description" style ="width : 20%">WORK TYPE</th>
					<th class="heading-description" style ="width : 20%">HP</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><textarea style="width: 100%;" class="clusterName" name="clusterName">{{order.clusterName}}</textarea></td>
					<td><textarea style="width: 100%;" class="siteId" name="siteId">{{order.siteId}}</textarea></td>
					<td>
						<select class = "type" name="type" id ="type">
						<option value="CLUSTER"  {% if order.type == 'CLUSTER' %}selected{% endif %}>CLUSTER</option>
						<option value="SUB FEEDER"  {% if order.type == 'SUB FEEDER' %}selected{% endif %}>SUB FEEDER</option>
						<option value="MAIN FEEDER"  {% if order.type == 'MAIN FEEDER' %}selected{% endif %}>MAIN FEEDER</option>
						<option value="OLT"  {% if order.type == 'OLT' %}selected{% endif %}>OLT</option>
						<option value="UNDERGROUND"  {% if order.type == 'UNDERGROUND' %}selected{% endif %}>UNDERGROUND</option>
					</select></td>
					<td>
						<select clas = "workType" name ="workType" id ="workType	">
							<option value="CW"  {% if order.workType == 'CW' %}selected{% endif %}>CW</option>
							<option value="EL"  {% if order.workType == 'EL' %}selected{% endif %}>EL</option>
						</select>
					</td>
					<td><input value="{{order.hp}}" type="text" class="HP" name="hp"></td>
				</tr>
			</tbody>
		</table>
	</div>

    {%else%}
    <div class="table-container">
		<table class="line-items-container">
			<thead>
				<tr>
					<th class="heading-description" style ="width : 20%" >CLUSTER NAME</th>
					<th class="heading-description" style ="width : 20%">ODB ID</th>
                    <th class="heading-description" style ="width : 20%">SUFFIX ID</th>
					<th class="heading-description" style ="width : 20%">TYPE</th>
					<th class="heading-description" style ="width : 20%">WORK TYPE</th>
					<th class="heading-description" style ="width : 20%">HP</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><textarea style="width: 100%;" class="clusterName" name="clusterName">{{order.clusterName}}</textarea></td>
					<td><textarea style="width: 100%;" class="odbId" name="odbId">{{order.odbId}}</textarea></td>
					<td><textarea style="width: 100%;" class="suffixId" name="suffixId">{{order.suffixId}}</textarea></td>

					<td>
						<select class = "type" name="type" id ="type">
						<option value="CLUSTER"  {% if order.type == 'CLUSTER' %}selected{% endif %}>CLUSTER</option>
						<option value="SUB FEEDER"  {% if order.type == 'SUB FEEDER' %}selected{% endif %}>SUB FEEDER</option>
						<option value="MAIN FEEDER"  {% if order.type == 'MAIN FEEDER' %}selected{% endif %}>MAIN FEEDER</option>
						<option value="OLT"  {% if order.type == 'OLT' %}selected{% endif %}>OLT</option>
						<option value="UNDERGROUND"  {% if order.type == 'UNDERGROUND' %}selected{% endif %}>UNDERGROUND</option>
					</select></td>
					<td>
						<select clas = "workType" name ="workType" id ="workType	">
							<option value="CW"  {% if order.workType == 'CW' %}selected{% endif %}>CW</option>
							<option value="EL"  {% if order.workType == 'EL' %}selected{% endif %}>EL</option>
						</select>
					</td>
					<td><input value="{{order.hp}}" type="text" class="HP" name="hp"></td>
				</tr>
			</tbody>
		</table>
	</div>
    {%endif%}

	
	<button class="button add-new-button" onclick=add() type="button">+</button>
	<table class="line-items-container" id="scopeOfWork" >
		<thead>
			<tr>
				<th style ="width : 4%">NO</th>
				<th style ="width: 26%;">SCOPE OF WORK</th>
				<th style ="width : 10%">QTY (BOQ)</th>
				<th style ="width : 10%">QTY (ACTUAL)</th>
				<th style ="width : 10%">UNIT PRICE</th>
				<th style ="width : 10%">TOTAL (BOQ)</th>
				<th style ="width : 10%">TOTAL (ACTUAL)</th>
				<th style ="width : 20%">REMARKS</th>
				<th style ="width : 0%;"></th>
			</tr>
		</thead>
		<tbody>
            {%for scope in order.workOrder.all%}
            {% if order.pricing_type == 'traditional'%}
            <tr>
                <td style = "text-align: center;" class="line-items-container">{{ forloop.counter }}</td> <!-- This will auto-increment the row number -->
                <td style="text-align: left;">
					{% with options="Pulling Cable-24 core (AE) include install the Accessory,Pulling Cable-48 core (AE) include install the Accessory,Pulling Cable-96 core (AE) include install the Accessory,Pulling Cable-144 core (AE) include install the Accessory,Instal Label Cable (on pole, in Handhole),Instal Label FDT,Instal Label FAT,Instal Label Pole,Instal pole 7 & 9 meter 4 inch include the foundation,Instal pole 7 meter 3 inch include the foundation,Instal Cable Hanger,Instal Sling Wire,Instal FDT,Instal FAT include the Splicing & Splitter,Splicing FDT / JC,Install JC,Testcomm OPM / OTDR" %}
                    {% if scope.scopeOfWork in options %}
					<select style="text-align: left;" class="line-items-container" name ="scopeOfWork_{{ forloop.counter|add:"-1" }}" >
                    <option value ="Pulling Cable-24 core (AE) include install the Accessory" data-price = 2500  {% if scope.scopeOfWork == 'Pulling Cable-24 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-24 core (AE) include install the Accessory</option>
                    <option value ="Pulling Cable-48 core (AE) include install the Accessory" data-price = 2500  {% if scope.scopeOfWork == 'Pulling Cable-48 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-48 core (AE) include install the Accessory</option>
                    <option value ="Pulling Cable-96 core (AE) include install the Accessory" data-price = 2500  {% if scope.scopeOfWork == 'Pulling Cable-96 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-96 core (AE) include install the Accessory</option>
                    <option value ="Pulling Cable-144 core (AE) include install the Accessory" data-price = 3000  {% if scope.scopeOfWork == 'Pulling Cable-144 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-144 core (AE) include install the Accessory</option>
                    <option value ="Instal Label Cable (on pole, in Handhole)" data-price = 2000  {% if scope.scopeOfWork == 'Instal Label Cable (on pole, in Handhole)' %}selected{% endif %}>Instal Label Cable (on pole, in Handhole)</option>
                    <option value ="Instal Label FDT" data-price = 2000 {% if scope.scopeOfWork == 'Instal Label FDT' %}selected{% endif %}>Instal Label FDT</option>
                    <option value ="Instal Label FAT" data-price = 2000 {% if scope.scopeOfWork == 'Instal Label FAT' %}selected{% endif %}>Instal Label FAT</option>
                    <option value ="Instal Label Pole" data-price = 2000 {% if scope.scopeOfWork == 'Instal Label Pole' %}selected{% endif %}>Instal Label Pole</option>
                    <option value ="Instal pole 7 & 9 meter 4 inch include the foundation" data-price = 135000 {% if scope.scopeOfWork == 'Instal pole 7 & 9 meter 4 inch include the foundation' %}selected{% endif %}>Instal pole 7 & 9 meter 4 inch include the foundation</option>
                    <option value ="Instal pole 7 meter 3 inch include the foundation" data-price = 130000 {% if scope.scopeOfWork == 'Instal pole 7 meter 3 inch include the foundation' %}selected{% endif %}>Instal pole 7 meter 3 inch include the foundation</option>
                    <option value ="Instal Cable Hanger" data-price = 20000 {% if scope.scopeOfWork == 'Instal Cable Hanger' %}selected{% endif %}>Instal Cable Hanger</option>
                    <option value ="Instal Sling Wire" data-price = 2500 {% if scope.scopeOfWork == 'Instal Sling Wire' %}selected{% endif %}>Instal Sling Wire</option>
                    <option value ="Instal FDT" data-price = 130000 {% if scope.scopeOfWork == 'Instal FDT' %}selected{% endif %}>Instal FDT</option>
                    <option value ="Instal FAT include the Splicing & Splitter" data-price = 150000 {% if scope.scopeOfWork == 'Instal FAT include the Splicing & Splitter' %}selected{% endif %}>Instal FAT include the Splicing & Splitter</option>
                    <option value ="Splicing FDT / JC" data-price = 20000 {% if scope.scopeOfWork == 'Splicing FDT / JC' %}selected{% endif %}>Splicing FDT / JC</option>
					<option value ="Install JC" data-price = 50000 {% if scope.scopeOfWork == 'Install JC' %}selected{% endif %}>Install JC</option>
					<option value ="Testcomm OPM / OTDR" data-price = 10000 {% if scope.scopeOfWork == 'Testcomm OPM / OTDR' %}selected{% endif %}>Testcomm OPM / OTDR</option>
				</select>
				{%else%}
				<input type="text" id="scopeOfWork_{{ forloop.counter|add:'-1' }}" name="scopeOfWork_{{ forloop.counter|add:'-1' }}" value="{{scope.scopeOfWork}}" style="display:block;">
				{%endif%}
				{%endwith%}
			
			</td>
                <td><input class="line-items-container" type="number" name ="qtyB_{{ forloop.counter|add:"-1" }}" value="{{ scope.qtyBoq }}"></td>
                <td><input class="line-items-container" type="number" name ="qtyA_{{ forloop.counter|add:"-1" }}" value="{{ scope.qtyActual }}"></td>
                <td><input class="line-items-container" type ="text"name ="unitPrice_{{ forloop.counter|add:"-1" }}" value="{{ scope.unitPrice }}"></td>
                <td><input class="line-items-container" type="text" name ="totalB_{{ forloop.counter|add:"-1" }}" value="{{ scope.totalBoq }}"></td>
                <td><input class="line-items-container" type="text" name ="totalA_{{ forloop.counter|add:"-1" }}" value="{{ scope.totalActual }}"></td>
                <td><input class="line-items-container" type="text" name ="remarks_{{ forloop.counter|add:"-1" }}" value="{{ scope.remarks }}"></td>
                <td><button class ="button add-new-button removeRowButton" id ="removeRow" >-</button></td>      
                </tr> 
            {% elif order.pricing_type == 'internal'%}
            <tr>
            <td style = "text-align: center;" class="line-items-container">{{ forloop.counter }}</td> <!-- This will auto-increment the row number -->
            <td style="text-align: left;">
				{% with options="Pulling Cable-24 core (AE) include install the Accessory,Pulling Cable-48 core (AE) include install the Accessory,Pulling Cable-96 core (AE) include install the Accessory,Pulling Cable-144 core (AE) include install the Accessory,Instal Label Cable (on pole, in Handhole),Instal Label FDT,Instal Label FAT,Instal Label Pole,Instal pole 7 & 9 meter 4 inch include the foundation,Instal pole 7 meter 3 inch include the foundation,Instal Cable Hanger,Instal Sling Wire,Instal FDT,Instal FAT include the Splicing & Splitter,Splicing FDT / JC,Install JC,Testcomm OPM / OTDR" %}
				{% if scope.scopeOfWork in options %}
				<select style="text-align: left;" class="line-items-container" name ="scopeOfWork_{{ forloop.counter|add:"-1" }}">
                <option value ="Pulling Cable-24 core (AE) include install the Accessory" data-price = 1600  {% if scope.scopeOfWork == 'Pulling Cable-24 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-24 core (AE) include install the Accessory</option>
                <option value ="Pulling Cable-48 core (AE) include install the Accessory" data-price = 1600  {% if scope.scopeOfWork == 'Pulling Cable-48 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-48 core (AE) include install the Accessory</option>
                <option value ="Pulling Cable-96 core (AE) include install the Accessory" data-price = 1600  {% if scope.scopeOfWork == 'Pulling Cable-96 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-96 core (AE) include install the Accessory</option>
                <option value ="Pulling Cable-144 core (AE) include install the Accessory" data-price = 2000  {% if scope.scopeOfWork == 'Pulling Cable-144 core (AE) include install the Accessory' %}selected{% endif %}>Pulling Cable-144 core (AE) include install the Accessory</option>
                <option value ="Instal Label Cable (on pole, in Handhole)" data-price = 2000  {% if scope.scopeOfWork == 'Instal Label Cable (on pole, in Handhole)' %}selected{% endif %}>Instal Label Cable (on pole, in Handhole)</option>
                <option value ="Instal Label FDT" data-price = 2000 {% if scope.scopeOfWork == 'Instal Label FDT' %}selected{% endif %}>Instal Label FDT</option>
                <option value ="Instal Label FAT" data-price = 2000 {% if scope.scopeOfWork == 'Instal Label FAT' %}selected{% endif %}>Instal Label FAT</option>
                <option value ="Instal Label Pole" data-price = 2000 {% if scope.scopeOfWork == 'Instal Label Pole' %}selected{% endif %}>Instal Label Pole</option>
                <option value ="Instal pole 7 & 9 meter 4 inch include the foundation" data-price = 110000 {% if scope.scopeOfWork == 'Instal pole 7 & 9 meter 4 inch include the foundation' %}selected{% endif %}>Instal pole 7 & 9 meter 4 inch include the foundation</option>
                <option value ="Instal pole 7 meter 3 inch include the foundation" data-price = 110000 {% if scope.scopeOfWork == 'Instal pole 7 meter 3 inch include the foundation' %}selected{% endif %}>Instal pole 7 meter 3 inch include the foundation</option>
                <option value ="Instal Cable Hanger" data-price = 20000 {% if scope.scopeOfWork == 'Instal Cable Hanger' %}selected{% endif %}>Instal Cable Hanger</option>
                <option value ="Instal Sling Wire" data-price = 1600 {% if scope.scopeOfWork == 'Instal Sling Wire' %}selected{% endif %}>Instal Sling Wire</option>
                <option value ="Instal FDT" data-price = 120000 {% if scope.scopeOfWork == 'Instal FDT' %}selected{% endif %}>Instal FDT</option>
                <option value ="Instal FAT include the Splicing & Splitter" data-price = 130000 {% if scope.scopeOfWork == 'Instal FAT include the Splicing & Splitter' %}selected{% endif %}>Instal FAT include the Splicing & Splitter</option>
                <option value ="Splicing FDT / JC" data-price = 20000 {% if scope.scopeOfWork == 'Splicing FDT / JC' %}selected{% endif %}>Splicing FDT / JC</option>
				<option value ="Install JC" data-price = 50000 {% if scope.scopeOfWork == 'Install JC' %}selected{% endif %}>Install JC</option>
				<option value ="Testcomm OPM / OTDR" data-price = 10000 {% if scope.scopeOfWork == 'Testcomm OPM / OTDR' %}selected{% endif %}>Testcomm OPM / OTDR</option>
			</select>
				{%else%}
			<input type="text" id="scopeOfWork_{{ forloop.counter|add:'-1' }}" name="scopeOfWork_{{ forloop.counter|add:'-1' }}" value="{{scope.scopeOfWork}}" style="display:block;">
				{%endif%}
				{%endwith%}
		</td>
            <td><input class="line-items-container" type="number" name ="qtyB_{{ forloop.counter|add:"-1" }}" value="{{ scope.qtyBoq }}"></td>
            <td><input class="line-items-container" type="number" name ="qtyA_{{ forloop.counter|add:"-1" }}" value="{{ scope.qtyActual }}"></td>
            <td><input class="line-items-container" type ="text"name ="unitPrice_{{ forloop.counter|add:"-1" }}" value="{{ scope.unitPrice }}"></td>
            <td><input class="line-items-container" type="text" name ="totalB_{{ forloop.counter|add:"-1" }}" value="{{ scope.totalBoq }}"></td>
            <td><input class="line-items-container" type="text" name ="totalA_{{ forloop.counter|add:"-1" }}" value="{{ scope.totalActual }}"></td>
            <td><input class="line-items-container" type="text" name ="remarks_{{ forloop.counter|add:"-1" }}" value="{{ scope.remarks }}"></td>
            <td><button class ="button add-new-button removeRowButton" id ="removeRow" >-</button></td>       
        </tr>
            {%else%}
            <tr>
                <td style = "text-align: center;" class="line-items-container">{{ forloop.counter }}</td> <!-- This will auto-increment the row number -->
                <td style="text-align: left;">
					{% with options="MPO HUB FebS-D06,ODB HUB FebS-H05,Cascaded Box FebS-S11 (70/30),Cascaded Box FebS-S11(50/50),End Box FebS-F10,Expansion Box FebS-E09,48C Inline Joint Closure,24C Inline Joint Closure,12C Inline Joint Closure,Install Cross-section Frame,Install Label Cable,Install Label BOX,Install OLT,Pole Installation (Pole Provided by LN), Incl. Foundation / Reinstatment,Supply and Install STAY Wire (Including BESI SENGKAND, SEKANG ULIR 12MM, THIMBLE, STEEL WIRE, BULAOG GRIP, KAWAT IKAT and Concrete k-225),Supply and Install Strand Wire & Buldog Grip,Supply and Install Riser Pipe 1,5 inch (Including GI Pipe-3M and Clamps),30m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC),100m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC),100m MPO Cable (MPO- SC/UPC*8),200m MPO Cable (MPO- SC/UPC*8),300m MPO Cable (MPO- SC/UPC*8),400m MPO Cable (MPO- SC/UPC*8),500m MPO Cable (MPO- SC/UPC*8),600m MPO Cable (MPO- SC/UPC*8),10m MPO Cable(MPO-MPO),50m MPO Cable (MPO-MPO),100m MPO Cable (MPO-MPO),200m MPO Cable (MPO-MPO),300m MPO Cable (MPO-MPO),400m MPO Cable (MPO-MPO),500m MPO Cable (MPO-MPO),600m MPO Cable (MPO-MPO),700m MPO Cable (MPO-MPO),800m MPO Cable (MPO-MPO),5m Single-Core Cable (5mm Round Cable ZTE-ZTE),10m Single-Core Cable (5mm Round Cable ZTE-ZTE),250m Single-Core Cable (5mm Round Cable ZTE-ZTE),50m Single-Core Cable (5mm Round Cable ZTE-ZTE),80m Single-Core Cable (5mm Round Cable ZTE-ZTE),100m Single-Core Cable (5mm Round Cable ZTE-ZTE),120m Single-Core Cable (5mm Round Cable ZTE-ZTE),150m Single-Core Cable (5mm Round Cable ZTE-ZTE),200m Single-Core Cable (5mm Round Cable ZTE-ZTE),350m Single-Core Cable (5mm Round Cable ZTE-ZTE),400m Single-Core Cable (5mm Round Cable ZTE-ZTE),Penempatan FO (AE), Including Lashing,Penempatan FO (AE), Including Lashing (48 cores),Splicing FO Cable,Test & Comm for Distribution Optical Fiber,Test & Comm for Feeder Optical Fiber,Test & Comm for Backbone Optical Fiber" %}
					{% if scope.scopeOfWork in options %}					
					<select style="text-align: left;" class="line-items-container" name ="scopeOfWork_{{ forloop.counter|add:"-1" }}">
                    <option value="MPO HUB FebS-D06" data-price="10000" {% if scope.scopeOfWork == 'MPO HUB FebS-D06' %}selected{% endif %}>MPO HUB FebS-D06</option>
                    <option value="ODB HUB FebS-H05" data-price="10000" {% if scope.scopeOfWork == 'ODB HUB FebS-H05' %}selected{% endif %}>ODB HUB FebS-H05</option>
                    <option value="Cascaded Box FebS-S11 (70/30)" data-price="10000" {% if scope.scopeOfWork == 'Cascaded Box FebS-S11 (70/30)' %}selected{% endif %}>Cascaded Box FebS-S11 (70/30)</option>
                    <option value="Cascaded Box FebS-S11(50/50)" data-price="10000" {% if scope.scopeOfWork == 'Cascaded Box FebS-S11(50/50)' %}selected{% endif %}>Cascaded Box FebS-S11(50/50)</option>
                    <option value="End Box FebS-F10" data-price="10000" {% if scope.scopeOfWork == 'End Box FebS-F10' %}selected{% endif %}>End Box FebS-F10</option>
                    <option value="Expansion Box FebS-E09" data-price="10000" {% if scope.scopeOfWork == 'Expansion Box FebS-E09' %}selected{% endif %}>Expansion Box FebS-E09</option>
                    <option value="48C Inline Joint Closure" data-price="50000" {% if scope.scopeOfWork == '48C Inline Joint Closure' %}selected{% endif %}>48C Inline Joint Closure</option>
                    <option value="24C Inline Joint Closure" data-price="25000" {% if scope.scopeOfWork == '24C Inline Joint Closure' %}selected{% endif %}>24C Inline Joint Closure</option>
                    <option value="12C Inline Joint Closure" data-price="20000" {% if scope.scopeOfWork == '12C Inline Joint Closure' %}selected{% endif %}>12C Inline Joint Closure</option>
                    <option value="Install Cross-section Frame" data-price="15000" {% if scope.scopeOfWork == 'Install Cross-section Frame' %}selected{% endif %}>Install Cross-section Frame</option>
                    <option value="Install Label Cable" data-price="2000" {% if scope.scopeOfWork == 'Install Label Cable' %}selected{% endif %}>Install Label Cable</option>
                    <option value="Install Label BOX" data-price="2000" {% if scope.scopeOfWork == 'Install Label BOX' %}selected{% endif %}>Install Label BOX</option>
					<option value="Install OLT" data-price="500000" {% if scope.scopeOfWork == 'Install OLT' %}selected{% endif %}>Install OLT</option>
					<option value="Pole Installation (Pole Provided by LN), Incl. Foundation / Reinstatment" data-price="120000" {% if scope.scopeOfWork == 'Pole Installation (Pole Provided by LN), Incl. Foundation / Reinstatment' %}selected{% endif %}>Pole Installation (Pole Provided by LN), Incl. Foundation / Reinstatment</option>
                    <option value="Supply and Install STAY Wire (Including BESI SENGKAND, SEKANG ULIR 12MM, THIMBLE, STEEL WIRE, BULAOG GRIP, KAWAT IKAT and Concrete k-225)" data-price="2000" {% if scope.scopeOfWork == 'Supply and Install STAY Wire (Including BESI SENGKAND, SEKANG ULIR 12MM, THIMBLE, STEEL WIRE, BULAOG GRIP, KAWAT IKAT and Concrete k-225)' %}selected{% endif %}>Supply and Install STAY Wire (Including BESI SENGKAND, SEKANG ULIR 12MM, THIMBLE, STEEL WIRE, BULAOG GRIP, KAWAT IKAT and Concrete k-225)</option>
                    <option value="Supply and Install Strand Wire & Buldog Grip" data-price="2000" {% if scope.scopeOfWork == 'Supply and Install Strand Wire & Buldog Grip' %}selected{% endif %}>Supply and Install Strand Wire & Buldog Grip</option>
                    <option value="Supply and Install Riser Pipe 1,5 inch (Including GI Pipe-3M and Clamps)" data-price="50000" {% if scope.scopeOfWork == 'Supply and Install Riser Pipe 1,5 inch (Including GI Pipe-3M and Clamps)' %}selected{% endif %}>Supply and Install Riser Pipe 1,5 inch (Including GI Pipe-3M and Clamps)</option>
                    <option value="30m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)" data-price="30000" {% if scope.scopeOfWork == '30m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)' %}selected{% endif %}>30m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)</option>
                    <option value="100m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)" data-price="100000" {% if scope.scopeOfWork == '100m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)' %}selected{% endif %}>100m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)</option>
                    <option value="100m MPO Cable (MPO- SC/UPC*8)" data-price="100000" {% if scope.scopeOfWork == '100m MPO Cable (MPO- SC/UPC*8)' %}selected{% endif %}>100m MPO Cable (MPO- SC/UPC*8)</option>
                    <option value="200m MPO Cable (MPO- SC/UPC*8)" data-price="200000" {% if scope.scopeOfWork == '200m MPO Cable (MPO- SC/UPC*8)' %}selected{% endif %}>200m MPO Cable (MPO- SC/UPC*8)</option>
                    <option value="300m MPO Cable (MPO- SC/UPC*8)" data-price="300000" {% if scope.scopeOfWork == '300m MPO Cable (MPO- SC/UPC*8)' %}selected{% endif %}>300m MPO Cable (MPO- SC/UPC*8)</option>
                    <option value="400m MPO Cable (MPO- SC/UPC*8)" data-price="400000" {% if scope.scopeOfWork == '400m MPO Cable (MPO- SC/UPC*8)' %}selected{% endif %}>400m MPO Cable (MPO- SC/UPC*8)</option>
                    <option value="500m MPO Cable (MPO- SC/UPC*8)" data-price="500000" {% if scope.scopeOfWork == '500m MPO Cable (MPO- SC/UPC*8)' %}selected{% endif %}>500m MPO Cable (MPO- SC/UPC*8)</option>
                    <option value="600m MPO Cable (MPO- SC/UPC*8)" data-price="600000" {% if scope.scopeOfWork == '600m MPO Cable (MPO- SC/UPC*8)' %}selected{% endif %}>600m MPO Cable (MPO- SC/UPC*8)</option>
                    <option value="10m MPO Cable(MPO-MPO)" data-price="10000" {% if scope.scopeOfWork == '10m MPO Cable(MPO-MPO)' %}selected{% endif %}>10m MPO Cable(MPO-MPO)</option>
                    <option value="50m MPO Cable (MPO-MPO)" data-price="50000" {% if scope.scopeOfWork == '50m MPO Cable (MPO-MPO)' %}selected{% endif %}>50m MPO Cable (MPO-MPO)</option>
                    <option value="100m MPO Cable (MPO-MPO)" data-price="100000" {% if scope.scopeOfWork == '100m MPO Cable (MPO-MPO)' %}selected{% endif %}>100m MPO Cable (MPO-MPO)</option>
                    <option value="200m MPO Cable (MPO-MPO)" data-price="200000" {% if scope.scopeOfWork == '200m MPO Cable (MPO-MPO)' %}selected{% endif %}>200m MPO Cable (MPO-MPO)</option>
                    <option value="300m MPO Cable (MPO-MPO)" data-price="300000" {% if scope.scopeOfWork == '300m MPO Cable (MPO-MPO)' %}selected{% endif %}>300m MPO Cable (MPO-MPO)</option>
                    <option value="400m MPO Cable (MPO-MPO)" data-price="400000" {% if scope.scopeOfWork == '400m MPO Cable (MPO-MPO)' %}selected{% endif %}>400m MPO Cable (MPO-MPO)</option>
                    <option value="500m MPO Cable (MPO-MPO)" data-price="500000" {% if scope.scopeOfWork == '500m MPO Cable (MPO-MPO)' %}selected{% endif %}>500m MPO Cable (MPO-MPO)</option>
                    <option value="600m MPO Cable (MPO-MPO)" data-price="600000" {% if scope.scopeOfWork == '600m MPO Cable (MPO-MPO)' %}selected{% endif %}>600m MPO Cable (MPO-MPO)</option>
                    <option value="700m MPO Cable (MPO-MPO)" data-price="700000" {% if scope.scopeOfWork == '700m MPO Cable (MPO-MPO)' %}selected{% endif %}>700m MPO Cable (MPO-MPO)</option>
                    <option value="800m MPO Cable (MPO-MPO)" data-price="800000" {% if scope.scopeOfWork == '800m MPO Cable (MPO-MPO)' %}selected{% endif %}>800m MPO Cable (MPO-MPO)</option>
                    <option value="5m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="5000" {% if scope.scopeOfWork == '5m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>5m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="10m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="10000" {% if scope.scopeOfWork == '10m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>10m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="250m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="250000" {% if scope.scopeOfWork == '250m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>250m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="50m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="50000" {% if scope.scopeOfWork == '50m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>50m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="80m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="80000" {% if scope.scopeOfWork == '80m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>80m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="100m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="100000" {% if scope.scopeOfWork == '100m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>100m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="120m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="120000" {% if scope.scopeOfWork == '120m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>120m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="150m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="150000" {% if scope.scopeOfWork == '150m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>150m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="200m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="200000" {% if scope.scopeOfWork == '200m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>200m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="350m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="350000" {% if scope.scopeOfWork == '350m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>350m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="400m Single-Core Cable (5mm Round Cable ZTE-ZTE)" data-price="400000" {% if scope.scopeOfWork == '400m Single-Core Cable (5mm Round Cable ZTE-ZTE)' %}selected{% endif %}>400m Single-Core Cable (5mm Round Cable ZTE-ZTE)</option>
                    <option value="Penempatan FO (AE), Including Lashing" data-price="1600" {% if scope.scopeOfWork == 'Penempatan FO (AE), Including Lashing' %}selected{% endif %}>Penempatan FO (AE), Including Lashing</option>
                    <option value="Penempatan FO (AE), Including Lashing (48 cores)" data-price="1600" {% if scope.scopeOfWork == 'Penempatan FO (AE), Including Lashing (48 cores)' %}selected{% endif %}>Penempatan FO (AE), Including Lashing (48 cores)</option>
                    <option value="Splicing FO Cable" data-price="20000" {% if scope.scopeOfWork == 'Splicing FO Cable' %}selected{% endif %}>Splicing FO Cable</option>
                    <option value="Test & Comm for Distribution Optical Fiber" data-price="10000" {% if scope.scopeOfWork == 'Test & Comm for Distribution Optical Fiber' %}selected{% endif %}>Test & Comm for Distribution Optical Fiber</option>
                    <option value="Test & Comm for Feeder Optical Fiber" data-price="10000" {% if scope.scopeOfWork == 'Test & Comm for Feeder Optical Fiber' %}selected{% endif %}>Test & Comm for Feeder Optical Fiber</option>
                    <option value="Test & Comm for Backbone Optical Fiber" data-price="10000" {% if scope.scopeOfWork == 'Test & Comm for Backbone Optical Fiber' %}selected{% endif %}>Test & Comm for Backbone Optical Fiber</option>
                    
                </select>
				{%else%}
				<input type="text" id="scopeOfWork_{{ forloop.counter|add:'-1' }}" name="scopeOfWork_{{ forloop.counter|add:'-1' }}" value="{{scope.scopeOfWork}}" style="display:block;">
				{%endif%}
				{%endwith%}
			</td>
                <td><input class="line-items-container" type="number" name ="qtyB_{{ forloop.counter|add:"-1" }}" value="{{ scope.qtyBoq }}"></td>
                <td><input class="line-items-container" type="number" name ="qtyA_{{ forloop.counter|add:"-1" }}" value="{{ scope.qtyActual }}"></td>
                <td><input class="line-items-container" type ="text"name ="unitPrice_{{ forloop.counter|add:"-1" }}" value="{{ scope.unitPrice }}"></td>
                <td><input class="line-items-container" type="text" name ="totalB_{{ forloop.counter|add:"-1" }}" value="{{ scope.totalBoq }}"></td>
                <td><input class="line-items-container" type="text" name ="totalA_{{ forloop.counter|add:"-1" }}" value="{{ scope.totalActual }}"></td>
                <td><input class="line-items-container" type="text" name ="remarks_{{ forloop.counter|add:"-1" }}" value="{{ scope.remarks }}"></td>
                <td><button class ="button add-new-button removeRowButton" id ="removeRow" >-</button></td>       
            </tr>
            {%endif%}
        {%endfor%}
		</tbody>
		<tfoot>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td></td>
				<td id="grand-total-boq"><input type = "text" name ="grand-total-boq" value = "{{order.grandTotalBoq}}" style="text-align: center;"></td>
				<td id="grand-total-actual"> <input type = "text" name ="grand-total-actual" value = "{{order.grandTotalActual}}"  style="text-align: center;"></td>
				<td></td> 
				<td></td>
			</tr>
		</tfoot>
	</table>


  <!-- PAYMENT -->
  <div style="margin-top: 50px;">
    <button class="button add-new-button" onclick=addDeduction() type="button">+</button>
    <table class="line-items-container" id ="payment-table" border="1">
      <thead>
        <th style ="width : 25%">PAYMENT</th>
        <th style ="width : 25%">PERCENTAGE</th>
        <th style ="width : 25%">AMOUNT</th>
        <th style ="width : 25%">REMARKS</th>
      </thead>
      <tbody>
        <tr>
          <td>TOTAL</td>
          <td></td>
          <td id ="grand-total-payment"> <input type = "text" name ="grand-total-payment" value = "{{order.totalAmount}}"></td>
          <td><input type ="text" name ="remarks1" value ="{{order.remarks1}}"></td>
        </tr>
        <tr>
          <td>
			{% with options="FULL,DP,TERM 2 - Implementation Done,TERM 3 - ATP Done,TERM 4 - FAC Done,CASHBON,REMAINING" %}
			{%if order.paymentTerm in options%}
            <select name = "terms-selection" id ="terms-selection">
				<option  value ="FULL" data-percentage-amount = 100% data-remarks = '' {% if order.paymentTerm == 'FULL' %}selected{% endif %} >FULL</option>
				<option value = "DP" data-percentage-amount =30% data-remarks = '' {% if order.paymentTerm == 'DP' %}selected{% endif %}> DP </option>
                <option  value ="TERM 2" data-percentage-amount =40%  data-remarks = 'Implementation Done' {% if order.paymentTerm == 'TERM 2 - Implementation Done' %}selected{% endif %}>TERM 2</option>
                <option  value ="TERM 3" data-percentage-amount =20% data-remarks = 'ATP Done' {% if order.paymentTerm == 'TERM 3 - ATP Done' %}selected{% endif %}>TERM 3</option>
                <option  value ="TERM 4" data-percentage-amount =10% data-remarks = 'FAC Done' {% if order.paymentTerm == 'TERM 4 - FAC Done' %}selected{% endif %}>TERM 4</option>
                <option  value ="CASHBON" data-percentage-amount =0% data-remarks = '' {% if order.paymentTerm == 'CASHBON' %}selected{% endif %}>CASHBON</option>
                <option  value ="REMAINING" data-percentage-amount =0% data-remarks = ''  {% if order.paymentTerm == 'REMAINING' %}selected{% endif %}>REMAINING</option>
				<option  value ="CREATE" data-percentage-amount = 0% data-remarks = ''>CREATE</option>  

			</select>
			{%else%}
			<input type="text" id="terms-selection" name="terms-selection" value="{{order.paymentTerm}}" style="display:block;">
			{%endif%}
			{%endwith%}
            </td>
			<td><input type="text" id="terms-percentage-cell" name="terms-percentage-cell" value="{{order.termPercentage}}"></td>          
			<td id = "terms-amount-cell"><input type="text" id="terms-amount-cell" name="terms-amount-cell"value="{{order.termAmount}}"></td>
          <td style = "text-align: left;">
			<input type ="text" name ="payment-remarks-cell" value="{{order.termRemark}}">
		  </td>
        </tr>
        <tr>
          <td>
			<select name ="tax-cell" id ="tax-cell">
				<option value ="NO TAX" data-tax-percentage-amount = 0% {% if order.paymentTax == 'NO TAX' %}selected{% endif %}>NO TAX</option>
				<option value ="WHT-21" data-tax-percentage-amount = 2.5% {% if order.paymentTax == 'WHT-21' %}selected{% endif %}>TAX - WHT21</option>
				<option value ="WHT-23" data-tax-percentage-amount = 2% {% if order.paymentTax == 'WHT-23' %}selected{% endif %}>TAX - WHT23</option>
				<option value ="VAT" data-tax-percentage-amount = 11% {% if order.paymentTax == 'VAT' %}selected{% endif %}>TAX - VAT</option>
				<option value ="TAX" data-tax-percentage-amount = {{order.taxPercentage}} {% if order.paymentTax == 'TAX' %}selected{% endif %}>TAX</option>

			</select>
		</td>
          <td>
			<input type="text" id="tax-percentage-cell" name="tax-percentage-cell"  value="{{order.taxPercentage}}">       
		  </td>
          <td id = "tax-amount-cell"> <input type="text" id="tax-amount-cell" name="tax-amount-cell"value="{{order.taxAmount}}"></td>
          <td style = "text-align: left;"	>
			<input type ="text" name ="tax-remarks-cell" value="{{order.taxRemark}}">
		  </td>
        </tr>
        {% if order.deductions.all %}
		{% with total_deductions=order.deductions.all.count %}
		{% for deduction in order.deductions.all %}
			{% with reversed_index=forloop.revcounter0 %}
			<tr id="deduction-row" class="deduction-row">
				<td>
					<select name="deduction_{{ reversed_index }}">
						<option value="DEDUCTION" {% if deduction.deductOrAddition == 'DEDUCTION' %}selected{% endif %}>DEDUCTION</option>
						<option value="ADDITION" {% if deduction.deductOrAddition == 'ADDITION' %}selected{% endif %}>ADDITION</option>
					</select>
				</td>
				<td>
					<input type="text" name="deduction-percentage_{{ reversed_index }}" style="display: none;">
				</td>
				<td>
					<input type="text" value="{{ deduction.deductionAmount }}" name="ded-addition-amount-cell_{{ reversed_index }}" id="ded-addition-amount-cell_{{ reversed_index }}">
				</td>
				<td>
					<input type="text" value="{{ deduction.deductionRemarks }}" name="deduction-remarks_{{ reversed_index }}" id="deduction-remarks_{{ reversed_index }}">
				</td>
				<td>
					<button class="button add-new-button removeRowDed" id="removeRowDed" style="width: 25px;">-</button>
				</td>       
			</tr>
			{% endwith %}
		{% endfor %}
	{% endwith %}
        {% else %}
        <tr id="deduction-row" class="deduction-row">
        </tr>
    {% endif %}

      </tbody>
      <tfoot>
        <tr>
          <td> GRAND TOTAL </td>
          <td></td>
          <td id = "grand-total-payment2"><input type = "text" name ="grand-total-payment2" value = "{{order.finalGrandTotal}}"></td>
          <td><input type ="text" name ="remarks2" value="{{order.remarks2}}"></td>
        </tr>
      </tfoot>
    </table>
  </div>
  
    <!-- TERM PAYMENT -->
<button class="button add-new-button" onclick=addPayment() type="button">+</button>
  <table class="line-items-container"border="1"  id = "paymentTable" name ="paymentTable">	
    <thead>
      <th>PAYMENT TYPE</th>
      <th>PERCENTAGE</th>
      <th>AMOUNT</th>
      <th>STATUS</th>
      <th>DATE</th>
	  <th style ="width : 0%;"></th>
    </thead>
    <tbody>
		{% for paymentType in order.paymentInformation.all%}
		<tr>
			<td >  <input type = "text" name ="pType_{{ forloop.counter|add:"-1" }}" value = "{{paymentType.pType}}"></td>
			<td ><input type = "text" name ="pPercentage_{{ forloop.counter|add:"-1" }}"  value = "{{paymentType.pPercentage}}"></td>
			<td > <input type = "text" name ="pAmount_{{ forloop.counter|add:"-1" }}"  value = "{{paymentType.pAmount}}"></td>
			<td>
			  <select name ="pStatus_{{ forloop.counter|add:"-1" }}">
				  <option value ="DONE" {% if paymentType.pStatus == 'DONE' %}selected{% endif %}>DONE</option>
				  <option value ="REQUEST"{% if paymentType.pStatus == 'REQUEST' %}selected{% endif %}>REQUEST</option>
			  </select>
			</td>
			<td ><input type = "date" name ="pDate_{{ forloop.counter|add:"-1" }}"  value = "{{paymentType.pDate |date:'Y-m-d' }}"></td>
			<td><button class="button add-new-button removeRowPayment" id="removeRowPayment" style="width: 25px;">-</button>
			</td>
		</tr>
	  {%endfor%}
    </tbody>
  </table>

  <!-- DOCUMENT -->
  <table class="line-items-container"border="1">
    <thead>
      <th>DOCUMENT</th>
	  <th>STATUS</th>
    </thead>
	<tbody>
		<tr>
			<td>TEAM LIST</td>
			<td style = "text-align : left">
				{% if order.team_list %}
					<a href="{{ order.team_list.url }}">Download Attachment</a>
					<input type="file" name="team_list" id ="team_list">
					<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_team_list')" id="removeButton">Remove</button>				
					{% else %}
					No attachment
					<input type="file" name="team_list" id ="team_list">
					<button type="button" onclick="clearFileInput('team_list')" id="removeButton">Remove</button>				

				{% endif %}
			</td>
		</tr>
		<tr>
			<td>PICTURE OF TEAM READY ON SITE					
			</td>
			<td style = "text-align : left">
				{% if order.picture_of_team %}
					<a href="{{ order.picture_of_team.url }}">Download Attachment</a>
					<input type="file" name="picture_of_team" id ="picture_of_team">
					<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_picture_of_team')" id="removeButton">Remove</button>			

				{% else %}
					No attachment
					<input type="file" name="picture_of_team" id ="picture_of_team">
					<button type="button" onclick="clearFileInput('picture_of_team')" id="removeButton">Remove</button>				

				{% endif %}
			</td>
		</tr>		
		<tr>
			<td>CHECKLIST BOQ ACTUAL					
			</td>
			<td style = "text-align : left">		
				{% if order.checklist_boq_actual_attachment %}
					<a href="{{ order.checklist_boq_actual_attachment.url }}">Download Attachment</a>
					<input type="file" name="checklist_boq_actual_attachment" id ="checklist_boq_actual_attachment">
					<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_checklist_boq_actual_attachment')" id="removeButton">Remove</button>				

				{% else %}
					No attachment
					<input type="file" name="checklist_boq_actual_attachment" id ="checklist_boq_actual_attachment">
					<button type="button" onclick="clearFileInput('checklist_boq_actual_attachment')" id="removeButton">Remove</button>				

				{% endif %}
			</td>
		</tr>		
		<tr>
			<td>COVER ACCEPTANCE SIGN BY CUSTOMER, PROJECT & COMPANY</td>
			<td style = "text-align : left">
				{% if order.cover_acceptance_attachment %}
					<a href="{{ order.cover_acceptance_attachment.url }}">Download Attachment</a>
					<input type="file" name="cover_acceptance_attachment" id="cover_acceptance_attachment">
					<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_cover_acceptance_attachment')" id="removeButton">Remove</button>				
				{% else %}
					No attachment
					<input type="file" name="cover_acceptance_attachment" id ="cover_acceptance_attachment">
					<button type="button" onclick="clearFileInput('cover_acceptance_attachment')" id="removeButton">Remove</button>				
				{% endif %}
			</td>
		</tr>	
<!-- COVER OPM & OTDR TEST -->
<tr>
    <td>COVER OPM & OTDR TEST</td>
    <td style = "text-align : left">        
        {% if order.cover_opm_attachment %}
            <a href="{{ order.cover_opm_attachment.url }}">Download Attachment</a>
			<input type="file" name="cover_opm_attachment" id="cover_opm_attachment">
			<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_cover_opm_attachment')" id="removeButton">Remove</button>				
			{% else %}
            No attachment
            <input type="file" name="cover_opm" id ="cover_opm_attachment">
			<button type="button" onclick="clearFileInput('cover_opm_attachment')" id="removeButton">Remove</button>				

        {% endif %}
    </td>
</tr>        

<!-- FAC CERTIFICATE -->
<tr>
    <td>FAC CERTIFICATE</td>
    <td style = "text-align : left">
        {% if order.fac_certificate %}
            <a href="{{ order.fac_certificate.url }}">Download Attachment</a>
			<input type="file" name="fac_certificate" id="fac_certificate">
			<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_fac_certificate')" id="removeButton">Remove</button>				
        {% else %}
            No attachment
            <input type="file" name="fac_certificate" id ="fac_certificate">
			<button type="button" onclick="clearFileInput('fac_certificate')" id="removeButton">Remove</button>				
			
        {% endif %}
    </td>
</tr>

<!-- NO ISSUE AGREEMENT -->
<tr>
    <td>NO ISSUE AGREEMENT</td>
    <td style = "text-align : left">
        {% if order.no_issue_agreement %}
            <a href="{{ order.no_issue_agreement.url }}">Download Attachment</a>
			<input type="file" name="no_issue_agreement" id="no_issue_agreement">
			<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_no_issue_agreement')" id="removeButton">Remove</button>				

        {% else %}
            No attachment
            <input type="file" name="no_issue_agreement" id ="no_issue_agreement">
			<button type="button" onclick="clearFileInput('no_issue_agreement')" id="removeButton">Remove</button>				

        {% endif %}
    </td>
</tr>

		<tr>
			<td>INVOICE / RECEIPT</td>
			<td style = "text-align : left">
				{% if order.invoice %}
					<a href="{{ order.invoice.url }}">Download Attachment</a>
					<input type="file" name="invoice" id="invoice">
					<button type="button" onclick="deleteAttachment({{ order.id }}, 'delete_invoice')" id="removeButton">Remove</button>
				{% else %}
					No attachment
					<input type="file" name="invoice" id ="invoice">
					<button type="button" onclick="clearFileInput('invoice')" id="removeButton">Remove</button>				
					{% endif %}
			</td>
		</tr>
	</tbody>
  </table>

  <!-- SIGN FIELD -->
  {% if order.company == 'aci' %}
  {% if order.project == 'EMR' %}
    <table class="line-items-container">
      <thead>
        <th>CREATED BY</th>
        <th colspan="2" style="text-align: center;">APPROVED BY</th>
      </thead>
      <tbody>
        <tr>
          <td style="height: 200px;">
          <td></td>
		  <td></td>
        </tr>
        <tr>
          <td><u>AGUNG SONATA</u></td>
          <td><u>TONY</u></td>
          <td><u>STEVEN</u></td>
        </tr>
        <tr>
          <td>PROCUREMENT</td>
          <td></td>
          <td>CEO</td>
        </tr>
      </tbody>
    </table>
  {% if order.project == 'LN' %}
    <table class="line-items-container">
      <thead>
        <th>CREATED BY</th>
        <th colspan="2" style="text-align: center;">APPROVED BY</th>
      </thead>
      <tbody>
        <tr>
          <td style="height: 200px;"></td>
          <td></td>
        </tr>
        <tr>
          <td><u>AGUNG SONATA</u></td>
          <td><u>SUNNY</u></td>
          <td><u>STEVEN</u></td>
        </tr>
        <tr>
          <td>PROCUREMENT</td>
          <td></td>
          <td>CEO</td>
        </tr>
      </tbody>
    </table>
  {% endif %}
{% endif %}
{% elif order.company == 'bks' %}

<table class="line-items-container">
<thead>
	<th>CREATED BY</th>
	<th>APPROVED BY</th>
</thead>
<tbody>
	<tr><td style="height: 200px;"><td></td></td></tr>
	<tr><td><u>ELSA MONICA</u></td><td><u>JENNY</u></td></tr>
	<tr><td>PROCUREMENT</td><td>CEO</td></tr>

</tbody>
</table>
{%else%} 
<table class="line-items-container">
<thead>
	<th>CREATED BY</th>
	<th>APPROVED BY</th>
</thead>
<tbody>
	<tr><td style="height: 200px;"><td></td></td></tr>
	<tr><td><u>AGUNG</u></td><td><u>FERONIA</u></td></tr>
	<tr><td>PROCUREMENT</td><td>CEO</td></tr>

</tbody>
</table>
{%endif%}


	<div class="footer">
		<div class="footer-info">
		</div>
	</div>

	<div>
		<button type="submit" id ="submitBtn"> Submit </button>
	</div>

	
	<input type="number" id="number_of_scopes" name="number_of_scopes" value="{{ order.scopeOfWorkCount }}" style="display: none;" >
	<input type="number" id="number_of_deduction" name="number_of_deduction" value="{{ order.deductionCount }}"  style="display: none;" >
	<input type="number" id="number_of_payment" name="number_of_payment" value="{{order.paymentCount}}" style="display: none;">

	<input type = "text" id = "pricing_type" name ="pricing_type" value ="{{order.pricing_type}}" style="display: none;">

</form>
<script type="text/javascript">
    var pricingType = "{{ order.pricing_type }}";
</script>



<script type="text/javascript">


	document.addEventListener("DOMContentLoaded", function(){
            document.getElementById("submitBtn").addEventListener("click", function(e){
                var woNumber = document.getElementById("wo_number").value;
                if (!woNumber) {
                    alert("The work order number cannot be empty.");
                    e.preventDefault(); // Prevent form submission
                }
            });
        });
</script>

<script>

function deleteAttachment(orderId, action) {
    if (!confirm('Are you sure you want to delete the attachment?')) {
        return; // Do nothing if the user cancels the confirmation dialog
    }

    var xhr = new XMLHttpRequest();
    xhr.open("POST", "{% url 'delete_attachment' order.id %}", true);
    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    xhr.setRequestHeader('X-CSRFToken', '{{ csrf_token }}');
    xhr.onreadystatechange = function() {
        if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
            // Handle success, such as updating the UI to reflect the deleted attachment
            alert('Attachment deleted successfully.');
        }
    }
    xhr.send('action=' + action);
}
function updateTotalActual(number){
    const qtyAElement = document.querySelector(`input[name='qtyA_${number}']`);
    const unitPriceElement = document.querySelector(`input[name='unitPrice_${number}']`);
    const totalAElement = document.querySelector(`input[name='totalA_${number}']`);
    
    const qtyA = parseFloat(qtyAElement.value) || 0;
    const unitPrice = parseFloat(unitPriceElement.value) || 0;
    
    const totalA = qtyA * unitPrice;
    totalAElement.value = totalA.toFixed(2);
}

function updateTotalBoq(number){
    const qtyBElement = document.querySelector(`input[name='qtyB_${number}']`);
    const unitPriceElement = document.querySelector(`input[name='unitPrice_${number}']`);
    const totalBElement = document.querySelector(`input[name='totalB_${number}']`);
    
    const qtyB = parseFloat(qtyBElement.value) || 0;
    const unitPrice = parseFloat(unitPriceElement.value) || 0;
    
    const totalB = qtyB * unitPrice;
    totalBElement.value = totalB.toFixed(2);
}
document.addEventListener('DOMContentLoaded', (event) => {
    document.body.addEventListener('change', function(event) {
        // Check if the changed element's name starts with 'scopeOfWork_'
        if (event.target.name && event.target.name.startsWith('scopeOfWork_')) {
            // Extract the number from the name
            const number = event.target.name.split('_')[1];
            // Get the selected option and its data-price attribute
            const selectedOption = event.target.options[event.target.selectedIndex];
            const dataPrice = selectedOption.getAttribute('data-price');
            
            // Check if dataPrice is a valid number before setting it
            if (dataPrice && !isNaN(dataPrice)) {
                // Find the corresponding unit price input and update its value
                const unitPriceElement = document.querySelector(`input[name='unitPrice_${number}']`);
                unitPriceElement.value = dataPrice;

                // After updating the unit price, you may want to update totals as well
                updateTotalActual(number);
                updateTotalBoq(number);
				updateTotals();
				termsAmountCalculation();
				taxAmountCalculation();
				updateGrandTotal();
            }
        }
    });
});
document.addEventListener('input', function(event) {
    const target = event.target;
    const name = target.name;
    
    if (name) {
        let number = '';
        if (name.startsWith('qtyA_')) {
            number = name.split('_')[1];
            updateTotalActual(number);
        } else if (name.startsWith('qtyB_')) {
            number = name.split('_')[1];
            updateTotalBoq(number);
        } else if (name.startsWith('unitPrice_')) {
            number = name.split('_')[1];
            // Update both totals since unit price affects both
            updateTotalActual(number);
            updateTotalBoq(number);
        } else if (name.startsWith('ded-addition-amount')){
			updateGrandTotal()
		}
    }
});

function termsAmountCalculation() {
  var selection = document.getElementById('terms-selection');
  if (selection.selectedIndex) {
	var selectedOption = selection.options[selection.selectedIndex];
  // Get the percentage either from the dropdown or from the custom input
  var percentageInput = document.getElementById('terms-percentage-cell').value;
  var percentageString = percentageInput !== '' ? percentageInput : selectedOption.getAttribute('data-percentage-amount');
  }
  else {
	var selectedOption = docucment.getElementById('terms-selection').value
	var percentageInput = document.getElementById('terms-percentage-cell').value;
	var percentageString = percentageInput 

  }
  // Remove any non-numeric characters (e.g., '%') and parse the percentage
  var cleanedPercentageString = percentageString.replace('%', '');
  var percentageNumber = parseFloat(cleanedPercentageString) / 100;

  // Retrieve the grand total value
  var grTotalCell = document.getElementById('grand-total-payment').querySelector('input').value;
  var grValue = parseFloat(grTotalCell) || 0;

  // Calculate and update the terms amount
  var calculatedAmount = percentageNumber * grValue;

  document.getElementById('terms-amount-cell').querySelector('input').value = calculatedAmount.toFixed(2)
  document.getElementById('terms-percentage-cell').value= percentageString;

}

function taxAmountCalculation(){
  var selection = document.getElementById('tax-cell');
  var selectedOption = selection.options[selection.selectedIndex];

  // Get the percentage either from the dropdown or from the custom input
  var percentageInput = document.getElementById('tax-percentage-cell').value;
  var percentageString = percentageInput !== '' ? percentageInput : selectedOption.getAttribute('data-percentage-amount');
  
  // Remove any non-numeric characters (e.g., '%') and parse the percentage
  var cleanedPercentageString = percentageString.replace('%', '');
  var percentageNumber = parseFloat(cleanedPercentageString) / 100;

  // Retrieve the grand total value
  var termAmoutCell = document.getElementById('terms-amount-cell').querySelector('input').value;
  var termAmoutCellValue = parseFloat(termAmoutCell) || 0;

  // Calculate and update the terms amount
  var calculatedAmount = percentageNumber * termAmoutCellValue;
  document.getElementById('tax-amount-cell').querySelector('input').value = calculatedAmount.toFixed(2);
}

function addDeduction(){
  var paymentTable = document.getElementById('payment-table')
  var deductionRow = document.getElementById('deduction-row')
  var rowIdx = deductionRow.rowIndex
  var newRow = paymentTable.insertRow(rowIdx)
  var number_of_deduction = document.getElementById('number_of_deduction'); 
  var currentCount = parseInt(number_of_deduction.value, 10) || 0; 
  for (i = 0 ; i < 5 ; i++){
	var cell = newRow.insertCell(i);
	if (i == 0){
		var selection = document.createElement('select')
		selection.name = "deduction_" + currentCount.toString()
		var option1 = document.createElement("option");
		option1.value = "DEDUCTION";
		option1.text = "DEDUCTION";
		selection.appendChild(option1);

		var option2 = document.createElement("option");
		option2.value = "ADDITION";
		option2.text = "ADDITION";
		selection.appendChild(option2);
		cell.appendChild(selection)
	}
	if (i == 1){
		var percentage_cell = document.createElement('input')
		percentage_cell.type = 'text'
		percentage_cell.name = 'deduction-percentage_' +currentCount.toString()
		percentage_cell.style.display = 'none'
		cell.appendChild(percentage_cell)
	}
	if (i == 2){
		var amount_cell = document.createElement('input')
		amount_cell.type = 'text'
		amount_cell.name = 'ded-addition-amount-cell_' + currentCount.toString()
		amount_cell.id = 'ded-addition-amount-cell_' + currentCount.toString()
		amount_cell.value = 0
		cell.appendChild(amount_cell)
		
	}
	if (i == 3){
		var remarks_cell = document.createElement('input')
		remarks_cell.type = 'text'
		remarks_cell.name = 'deduction-remarks_' + currentCount.toString()
		cell.style.textAlign = 'left'
		cell.appendChild(remarks_cell)
	}
	if (i == 4) {
		var removeButton = document.createElement("button");
		removeButton.id = "removeRowDed"
		removeButton.className = "button add-new-button removeRowDed"
		removeButton.style.width = "25px"
		removeButton.textContent = "-"
		cell.appendChild(removeButton)
	}
    newRow.dataset.index = currentCount; // Set the new top row index
    number_of_deduction.value = (currentCount + 1).toString(); // Increment for the next new row
    // Now re-index all rows
    reIndexRowsDed('payment-table'); 
    }
}


function addUppercaseListener(element) {
  element.addEventListener('input', function() {
    this.value = this.value.toUpperCase();
  });
}

function updateGrandTotal() {
    var grandTotal = 0;

    // Select all input elements with an ID containing 'amount-cell'
    var amountInputs = document.querySelectorAll('input[id*="amount-cell"]');
    amountInputs.forEach(function(input) {
        // Parse the value of each input as a float
        var value = parseFloat(input.value) || 0;

        // Check if the ID is 'tax-amount-cell'
        if (input.id === 'tax-amount-cell') {
            // Subtract the tax amount from the total
            grandTotal -= value;
        } else {
            // Add the value to the total for other IDs
            grandTotal += value;
        }
    });

    // Update the grand total in the appropriate input field
    document.getElementById('grand-total-payment2').querySelector('input').value = grandTotal.toFixed(2);
}
function updateTotals() {
	var totalActual = 0;
	var totalBoq = 0;
	
	// Iterate through each row in the tbody
	var rows = document.querySelectorAll("#scopeOfWork tbody tr");
	rows.forEach(function(row) {
		// Assuming you have input fields in the 'Total (ACTUAL)' and 'Total (BOQ)' columns
		var actual = row.querySelector('[name^="totalA"]'); // Use the correct selector for your inputs
		var boq = row.querySelector('[name^="totalB"]'); // Use the correct selector for your inputs
		
		// Add the parsed values to the totals, ensuring they are numbers
		totalActual += actual ? parseFloat(actual.value) || 0 : 0;
		totalBoq += boq ? parseFloat(boq.value) || 0 : 0;
    
	});

	// Update the totals in the tfoot
	document.getElementById("grand-total-actual").querySelector('input').value = totalActual
	document.getElementById("grand-total-boq").querySelector('input').value = totalBoq
	if(totalActual) {
		document.getElementById("grand-total-payment").querySelector('input').value = totalActual
	}
	else{	
		document.getElementById("grand-total-payment").querySelector('input').value = totalBoq
	}
}

function reIndexRows(tableId) {
  var table = document.getElementById(tableId);
  var rows = table.querySelectorAll('tbody tr');

  // Start from 0 since we're iterating over tbody rows directly
  rows.forEach(function(row, index) {
    var newIndex = index;
    row.dataset.index = newIndex; // Update the dataset index
    var numberCell = row.cells[0]; // Update the visible row number
    numberCell.textContent = newIndex + 1;

    // Update the names of all input/select elements
    var inputs = row.querySelectorAll('input, select');
    inputs.forEach(function(input) {
      var name = input.name;
      if (name) {
        // Replace the old index with the new one
        input.name = name.replace(/_\d+$/, '_' + newIndex);
      } 
    });
  });
}
function reIndexRowsDed(tableId) {
  var table = document.getElementById(tableId);
  var rows = table.querySelectorAll('tr.deduction-row');
  var startingIndex = rows.length - 1; // Start with the highest index

  rows.forEach(function(row, index) {
    var newIndex = startingIndex - index; // Assign indices starting from the top
    row.dataset.index = newIndex; // Update the dataset index

    // Update the names of all input/select elements
    var inputs = row.querySelectorAll('input, select');
    inputs.forEach(function(input) {
      var name = input.name;
      if (name) {
        var match = name.match(/^(deduction_)(\d+)$/); // Assuming the format is "deduction_#"
        if (match) {
          input.name = match[1] + newIndex; // Replace with the new index
        }
      }
    });
  });
}
function reIndexRowsPayment(tableId) {
    var table = document.getElementById(tableId);
    var rows = table.querySelectorAll('tbody tr');
  rows.forEach(function(row, index) {
    var newIndex = index; 
    row.dataset.index = newIndex; // Update the dataset index

    // Update the names of all input/select elements
    var inputs = row.querySelectorAll('input, select');
    inputs.forEach(function(input) {
      var name = input.name;
      if (name) {
        // Replace the old index with the new one
        input.name = name.replace(/_\d+$/, '_' + newIndex);
      } 
    });
  });
}
var woProject = "{{ order.project }}";
function addPayment(){
	var paymentTable =  document.getElementById("paymentTable");
	var tbody = paymentTable.tBodies[0]
	var rows = tbody.rows.length;
	var r = tbody.insertRow(rows); // Insert the row at the end of this tbody
	var number_of_payment = document.getElementById("number_of_payment");
	var currentCount = parseInt(number_of_payment.value, 10)
	number_of_payment.value = currentCount + 1
	r.dataset.index = currentCount ;	

	for(var i = 0 ; i < 6 ;i++){
		var cell = r.insertCell(i);
		if (i == 0){
			var text = document.createElement("input");
			text.name = "pType_" + currentCount.toString()
			text.addEventListener('input', function() {
				this.value = this.value.toUpperCase();
        	});
			text.class = "line-items-container"
			cell.appendChild(text);			
		}
		if (i == 1){
			var text2 = document.createElement("input");
			text2.name = "pPercentage_" + currentCount.toString()
			text2.class = "line-items-container"
			cell.appendChild(text2);
		}
		if (i == 2){
			var text3 = document.createElement("input");
			text3.name = "pAmount_" + currentCount.toString()
			text3.class = "line-items-container"
			cell.appendChild(text3);			
		}
		if (i == 3){
			var selection = document.createElement("select");
			selection.name = "pStatus_" + currentCount.toString()
			cell.style.textAlign = "center";
			selection.class = "line-items-container"
			// Add options to the sele5t element
			var option1 = document.createElement("option");
			option1.value = "DONE";
			option1.text = "DONE";
			selection.appendChild(option1);

			var option2 = document.createElement("option");
			option2.value = "REQUEST";
			option2.text = "REQUEST";
			selection.appendChild(option2);		
			
			cell.appendChild(selection)
		}
		if (i == 4){
			var date = document.createElement("input")
			date.type = 'date'
			date.name = 'pDate_'+ currentCount.toString()
			cell.appendChild(date)
		}
		if (i == 5){
			var removeButton = document.createElement("button");
			removeButton.id = "removeRowPayment"
			removeButton.className = "button add-new-button removeRowPayment"
			removeButton.class = "line-items-container"
			removeButton.textContent = "-"
			cell.appendChild(removeButton)
		}
	}
}
function clearFileInput(id) {
    document.getElementById(id).value = "";
}
document.addEventListener('keypress', function(event) {
    // Check if the Enter key is pressed without the Shift key
    if (event.keyCode === 13 && !event.shiftKey) {
        // Check if the target of the keypress event is not a textarea
        if (event.target.tagName.toLowerCase() !== 'textarea') {
            event.preventDefault();
            return false;
        }
    }
});

function add() {
	var scopeOfWorkTable = document.getElementById("scopeOfWork");
	var tbody = scopeOfWorkTable.tBodies[0]
	var rows = tbody.rows.length;
	var r = tbody.insertRow(rows);
	var number_of_scopes = document.getElementById("number_of_scopes");
	var currentCount = parseInt(number_of_scopes.value, 10)
	number_of_scopes.value = currentCount + 1
	r.dataset.index = currentCount ;
	for (var i = 0; i < 9; i++) {
		var cell = r.insertCell(i);
		if (i == 0) {
			var num = r.insertCell(0)
			num.textContent = rows+1
			num.style.textAlign = "center";
			num.class = "line-items-container"

		}
		if (i == 1 && pricingType == 'internal' && woProject == 'LN') {
			var selection = document.createElement("select");
			selection.name = "scopeOfWork_" + currentCount.toString()
			cell.style.textAlign = "left";
			selection.class = "line-items-container"
			// Add options to the sele5t element
			var option1 = document.createElement("option");
			option1.value = "Pulling Cable-24 core (AE) include install the Accessory";
			option1.setAttribute('data-price', 1600)
			option1.text = "Pulling Cable-24 core (AE) include install the Accessory";
			selection.appendChild(option1);

			var option2 = document.createElement("option");
			option2.value = "Pulling Cable-48 core (AE) include install the Accessory";
			option2.setAttribute('data-price', 1600)
			option2.text = "Pulling Cable-48 core (AE) include install the Accessory";
			selection.appendChild(option2);

			var option3 = document.createElement("option");
			option3.value = "Pulling Cable-96 core (AE) include install the Accessory";
			option3.setAttribute('data-price', 1600)
			option3.text = "Pulling Cable-96 core (AE) include install the Accessory";
			selection.appendChild(option3);

			var option4 = document.createElement("option");
			option4.value = "Pulling Cable-144 core (AE) include install the Accessory";
			option4.setAttribute('data-price', 2000)
			option4.text = "Pulling Cable-144 core (AE) include install the Accessory";
			selection.appendChild(option4);

			var option5 = document.createElement("option");
			option5.value = "Instal Label Cable (on pole, in Handhole)";
			option5.setAttribute('data-price', 2000)
			option5.text = "Instal Label Cable (on pole, in Handhole)";
			selection.appendChild(option5);

			var option6 = document.createElement("option");
			option6.value = "Instal Label FDT";
			option6.setAttribute('data-price', 2000)
			option6.text = "Instal Label FDT";
			selection.appendChild(option6);

			var option7 = document.createElement("option");
			option7.value = "Instal Label FAT";
			option7.setAttribute('data-price', 2000)
			option7.text = "Instal Label FAT";
			selection.appendChild(option7);

			var option8 = document.createElement("option");
			option8.value = "Instal Label Pole";
			option8.setAttribute('data-price', 2000)
			option8.text = "Instal Label Pole";
			selection.appendChild(option8);

			var option9 = document.createElement("option");
			option9.value = "Instal pole 7 & 9 meter 4 inch include the foundation";
			option9.setAttribute('data-price', 110000)
			option9.text = "Instal pole 7 & 9 meter 4 inch include the foundation";
			selection.appendChild(option9);

			var option10 = document.createElement("option");
			option10.value = "Instal pole 7 meter 3 inch include the foundation";
			option10.setAttribute('data-price', 110000)
			option10.text = "Instal pole 7 meter 3 inch include the foundation";
			selection.appendChild(option10);

			var option11 = document.createElement("option");
			option11.value = "Instal Cable Hanger";
			option11.setAttribute('data-price', 20000)
			option11.text = "Instal Cable Hanger";
			selection.appendChild(option11);

			var option12 = document.createElement("option");
			option12.value = "Instal Sling Wire";
			option12.setAttribute('data-price', 1600)
			option12.text = "Instal Sling Wire";
			selection.appendChild(option12);

			var option13 = document.createElement("option");
			option13.value = "Instal FDT";
			option13.setAttribute('data-price', 120000)
			option13.text = "Instal FDT";
			selection.appendChild(option13);

			var option14 = document.createElement("option");
			option14.value = "Instal FAT include the Splicing & Splitter";
			option14.setAttribute('data-price', 130000)
			option14.text = "Instal FAT include the Splicing & Splitter";
			selection.appendChild(option14);

			var option15 = document.createElement("option");
			option15.value = "Splicing FDT / JC";
			option15.setAttribute('data-price', 20000)
			option15.text = "Splicing FDT / JC";
			selection.appendChild(option15);

			var option17 = document.createElement("option");
			option17.value = "Install JC";
			option17.setAttribute('data-price', 50000)
			option17.text = "Install JC";
			selection.appendChild(option17);
			
			var option18 = document.createElement("option");
			option18.value = "Testcomm OPM / OTDR";
			option18.setAttribute('data-price', 10000)
			option18.text = "Testcomm OPM / OTDR";
			selection.appendChild(option18);

			// User create custom object 
			var option16 = document.createElement("option");
			option16.value = "Add Custom Scope Of Work";
			option16.text = "Add Custom Scope Of Work"
			selection.appendChild(option16)
			// Updating the unit price when selecting items
			selection.onchange = function() {
				var selectedOption = this.options[this.selectedIndex]
				var selectedPrice = selectedOption.getAttribute('data-price')
				var unitPriceInput = this.parentNode.parentNode.cells[4].querySelector('input');
				unitPriceInput.value = selectedPrice
				var totalBoqInput = this.parentNode.parentNode.cells[5].querySelector('input')
				var qty = this.parentNode.parentNode.cells[2].querySelector('input')
				var totalActualInput = this.parentNode.parentNode.cells[6].querySelector('input')
				var qtyActual = this.parentNode.parentNode.cells[3].querySelector('input')
				var grandTotalUpdater = document.getElementById('grand-total-payment')
				grandTotalUpdater.addEventListener('change', function(event){
					this.value = unitPriceInput.value * qty
				});
				if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = qtyActual.value * unitPriceInput.value
					}
				if (this.value == "Add Custom Scope Of Work") {
					var customInput = document.createElement("input");
					this.style.display = "none"
					customInput.type = "text"
					customInput.name = "scopeOfWork_" + currentCount.toString()
					applyStyles(customInput, "text")
					this.parentNode.insertBefore(customInput, this.nextSibling);
					
				}
				qty.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * unitPriceInput.value
					
					updateTotals();
					termsAmountCalculation();
					taxAmountCalculation();
					updateGrandTotal();
				});
				unitPriceInput.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * qty.value
					
					updateTotals();
					termsAmountCalculation();
					taxAmountCalculation();
					updateGrandTotal();
				});
				totalBoqInput.value = unitPriceInput.value * qty.value;

				// Total Actual
				qtyActual.addEventListener('input', function(event) {
					if (this.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * unitPriceInput.value
						
						updateTotals();
						termsAmountCalculation();
						taxAmountCalculation();
						updateGrandTotal();
					}
				});
				unitPriceInput.addEventListener('input', function(event) {
					if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * qtyActual.value
						
						updateTotals();
						termsAmountCalculation();
						taxAmountCalculation();
						updateGrandTotal();
					}
				});
			};
			cell.appendChild(selection);
		}
		if (i == 1 && pricingType == 'traditional' && woProject == 'LN') {
			var selection = document.createElement("select");
			selection.name = "scopeOfWork_" + currentCount.toString()
			cell.style.textAlign = "left";
			selection.class = "line-items-container"
			// Add options to the sele5t element
			var option1 = document.createElement("option");
			option1.value = "Pulling Cable-24 core (AE) include install the Accessory";
			option1.setAttribute('data-price', 2500)
			option1.text = "Pulling Cable-24 core (AE) include install the Accessory";
			selection.appendChild(option1);

			var option2 = document.createElement("option");
			option2.value = "Pulling Cable-48 core (AE) include install the Accessory";
			option2.setAttribute('data-price', 2500)
			option2.text = "Pulling Cable-48 core (AE) include install the Accessory";
			selection.appendChild(option2);

			var option3 = document.createElement("option");
			option3.value = "Pulling Cable-96 core (AE) include install the Accessory";
			option3.setAttribute('data-price', 2500)
			option3.text = "Pulling Cable-96 core (AE) include install the Accessory";
			selection.appendChild(option3);

			var option4 = document.createElement("option");
			option4.value = "Pulling Cable-144 core (AE) include install the Accessory";
			option4.setAttribute('data-price', 3000)
			option4.text = "Pulling Cable-144 core (AE) include install the Accessory";
			selection.appendChild(option4);

			var option5 = document.createElement("option");
			option5.value = "Instal Label Cable (on pole, in Handhole)";
			option5.setAttribute('data-price', 2000)
			option5.text = "Instal Label Cable (on pole, in Handhole)";
			selection.appendChild(option5);

			var option6 = document.createElement("option");
			option6.value = "Instal Label FDT";
			option6.setAttribute('data-price', 2000)
			option6.text = "Instal Label FDT";
			selection.appendChild(option6);

			var option7 = document.createElement("option");
			option7.value = "Instal Label FAT";
			option7.setAttribute('data-price', 2000)
			option7.text = "Instal Label FAT";
			selection.appendChild(option7);

			var option8 = document.createElement("option");
			option8.value = "Instal Label Pole";
			option8.setAttribute('data-price', 2000)
			option8.text = "Instal Label Pole";
			selection.appendChild(option8);

			var option9 = document.createElement("option");
			option9.value = "Instal pole 7 & 9 meter 4 inch include the foundation";
			option9.setAttribute('data-price', 135000)
			option9.text = "Instal pole 7 & 9 meter 4 inch include the foundation";
			selection.appendChild(option9);

			var option10 = document.createElement("option");
			option10.value = "Instal pole 7 meter 3 inch include the foundation";
			option10.setAttribute('data-price', 130000)
			option10.text = "Instal pole 7 meter 3 inch include the foundation";
			selection.appendChild(option10);

			var option11 = document.createElement("option");
			option11.value = "Instal Cable Hanger";
			option11.setAttribute('data-price', 20000)
			option11.text = "Instal Cable Hanger";
			selection.appendChild(option11);

			var option12 = document.createElement("option");
			option12.value = "Instal Sling Wire";
			option12.setAttribute('data-price', 2500)
			option12.text = "Instal Sling Wire";
			selection.appendChild(option12);

			var option13 = document.createElement("option");
			option13.value = "Instal FDT";
			option13.setAttribute('data-price', 130000)
			option13.text = "Instal FDT";
			selection.appendChild(option13);

			var option14 = document.createElement("option");
			option14.value = "Instal FAT include the Splicing & Splitter";
			option14.setAttribute('data-price', 150000)
			option14.text = "Instal FAT include the Splicing & Splitter";
			selection.appendChild(option14);

			var option15 = document.createElement("option");
			option15.value = "Splicing FDT / JC";
			option15.setAttribute('data-price', 20000)
			option15.text = "Splicing FDT / JC";
			selection.appendChild(option15);

			var option17 = document.createElement("option");
			option17.value = "Install JC";
			option17.setAttribute('data-price', 50000)
			option17.text = "Install JC";
			selection.appendChild(option17);

			// User create custom object 
			var option16 = document.createElement("option");
			option16.value = "Add Custom Scope Of Work";
			option16.text = "Add Custom Scope Of Work"
			selection.appendChild(option16)
			// Updating the unit price when selecting items
			selection.onchange = function() {
				var selectedOption = this.options[this.selectedIndex]
				var selectedPrice = selectedOption.getAttribute('data-price')
				var unitPriceInput = this.parentNode.parentNode.cells[4].querySelector('input');
				unitPriceInput.value = selectedPrice
				var totalBoqInput = this.parentNode.parentNode.cells[5].querySelector('input')
				var qty = this.parentNode.parentNode.cells[2].querySelector('input')
				var totalActualInput = this.parentNode.parentNode.cells[6].querySelector('input')
				var qtyActual = this.parentNode.parentNode.cells[3].querySelector('input')
				var grandTotalUpdater = document.getElementById('grand-total-payment')
				grandTotalUpdater.addEventListener('change', function(event){
					this.value = unitPriceInput.value * qty
				});
				if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = qtyActual.value * unitPriceInput.value
					}
				if (this.value == "Add Custom Scope Of Work") {
					var customInput = document.createElement("input");
					this.style.display = "none"
					customInput.type = "text"
					customInput.name = "scopeOfWork_" + currentCount.toString()
					applyStyles(customInput, "text")
					this.parentNode.insertBefore(customInput, this.nextSibling);
					
				}
				qty.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * unitPriceInput.value
					
					updateTotals();
					termsAmountCalculation();
					taxAmountCalculation();
					updateGrandTotal();
				});
				unitPriceInput.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * qty.value
					
					updateTotals();
					termsAmountCalculation();
					taxAmountCalculation();
					updateGrandTotal();
				});
				totalBoqInput.value = unitPriceInput.value * qty.value;

				// Total Actual
				qtyActual.addEventListener('input', function(event) {
					if (this.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * unitPriceInput.value
						
						updateTotals();
						termsAmountCalculation();
						taxAmountCalculation();
						updateGrandTotal();
					}
				});
				unitPriceInput.addEventListener('input', function(event) {
					if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * qtyActual.value
						
						updateTotals();
						termsAmountCalculation();
						taxAmountCalculation();
						updateGrandTotal();
					}
				});
			};
			cell.appendChild(selection);
		}
        if (i == 1 && pricingType == 'odn' && woProject == 'LN') {
			var selection = document.createElement("select");
			selection.name = "scopeOfWork_" + currentCount.toString()
			cell.style.textAlign = "left";
			selection.class = "line-items-container"
			// Add options to the sele5t element
			var option1 = document.createElement("option");
			option1.value = "MPO HUB FebS-D06";
			option1.setAttribute('data-price', 10000)
			option1.text = "MPO HUB FebS-D06";
			selection.appendChild(option1);

			var option2 = document.createElement("option");
			option2.value = "ODB HUB FebS-H05";
			option2.setAttribute('data-price', 10000)
			option2.text = "ODB HUB FebS-H05";
			selection.appendChild(option2);

			var option3 = document.createElement("option");
			option3.value = "Cascaded Box FebS-S11 (70/30)";
			option3.setAttribute('data-price', 10000)
			option3.text = "Cascaded Box FebS-S11 (70/30)";
			selection.appendChild(option3);

			var option4 = document.createElement("option");
			option4.value = "Cascaded Box FebS-S11(50/50)";
			option4.setAttribute('data-price', 10000)
			option4.text = "Cascaded Box FebS-S11(50/50)";
			selection.appendChild(option4);

			var option5 = document.createElement("option");
			option5.value = "End Box FebS-F10";
			option5.setAttribute('data-price', 10000)
			option5.text = "End Box FebS-F10";
			selection.appendChild(option5);

			var option6 = document.createElement("option");
			option6.value = "Expansion Box FebS-E09";
			option6.setAttribute('data-price', 10000)
			option6.text = "Expansion Box FebS-E09";
			selection.appendChild(option6);

			var option7 = document.createElement("option");
			option7.value = "48C Inline Joint Closure";
			option7.setAttribute('data-price', 50000)
			option7.text = "48C inline Joint Closure";
			selection.appendChild(option7);

			var option8 = document.createElement("option");
			option8.value = "24C Inline Joint Closure";
			option8.setAttribute('data-price', 25000)
			option8.text = "24C inline Joint Closure";
			selection.appendChild(option8);

			var option9 = document.createElement("option");
			option9.value = "12C Inline Joint Closure";
			option9.setAttribute('data-price', 20000)
			option9.text = "12C inline Joint Closure";
			selection.appendChild(option9);

			var option10 = document.createElement("option");
			option10.value = "Install Cross-section Frame";
			option10.setAttribute('data-price', 15000)
			option10.text = "Install Cross-section Frame";
			selection.appendChild(option10);

			var option11 = document.createElement("option");
			option11.value = "Install Label Cable";
			option11.setAttribute('data-price', 2000)
			option11.text = "Install Label Cable";
			selection.appendChild(option11);

			var option12 = document.createElement("option");
			option12.value = "Install Label BOX";
			option12.setAttribute('data-price', 2000)
			option12.text = "Install Label BOX";
			selection.appendChild(option12);
			
			var option52 = document.createElement("option");
			option52.value = "Install OLT";
			option52.setAttribute('data-price', 500000)
			option52.text = "Install OLT";
			selection.appendChild(option52);
			var option13 = document.createElement("option");
			option13.value = "Pole Installation (Pole Provided by LN), Incl. Foundation / Reinstatment";
			option13.setAttribute('data-price', 120000)
			option13.text = "Pole Installation (Pole Provided by LN), Incl. Foundation / Reinstatment";
			selection.appendChild(option13);

			var option14 = document.createElement("option");
			option14.value = "Supply and Install STAY Wire (Including BESI SENGKAND, SEKANG ULIR 12MM, 			THIMBLE, STEEL WIRE, BULAOG GRIP, KAWAT IKAT and Concrete k-225)";
			option14.setAttribute('data-price', 2000)
			option14.text = "Supply and Install STAY Wire (Including BESI SENGKAND, SEKANG ULIR 12MM, 				THIMBLE, STEEL WIRE, BULAOG GRIP, KAWAT IKAT and Concrete k-225)";
			selection.appendChild(option14);

			var option15 = document.createElement("option");
			option15.value = "Supply and Install Strand Wire & Buldog Grip";
			option15.setAttribute('data-price', 2000)
			option15.text = "Supply and Install Strand Wire & Buldog Grip";
			selection.appendChild(option15);

			var option16 = document.createElement("option");
			option16.value = "Supply and Install Riser Pipe 1,5 inch (Including GI Pipe-3M and Clamps)";
			option16.setAttribute('data-price', 50000)
			option16.text = "Supply and Install Riser Pipe 1,5 inch (Including GI Pipe-3M and Clamps)";
			selection.appendChild(option16);

			var option17 = document.createElement("option");
			option17.value = "30m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)";
			option17.setAttribute('data-price', 30000)
			option17.text = "30m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)";
			selection.appendChild(option17);

			var option18 = document.createElement("option");
			option18.value = "100m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)";
			option18.setAttribute('data-price', 100000)
			option18.text = "100m DLC Cable (12LC/UPC-6LC/UPC+6FC/UPC)";
			selection.appendChild(option18);

			var option19 = document.createElement("option");
			option19.value = "100m MPO Cable (MPO- SC/UPC*8)";
			option19.setAttribute('data-price', 100000)
			option19.text = "100m MPO Cable (MPO- SC/UPC*8)";
			selection.appendChild(option19);

			var option20 = document.createElement("option");
			option20.value = "200m MPO Cable (MPO- SC/UPC*8)";
			option20.setAttribute('data-price', 200000)
			option20.text = "200m MPO Cable (MPO- SC/UPC*8)";
			selection.appendChild(option20);

			var option21 = document.createElement("option");
			option21.value = "300m MPO Cable (MPO- SC/UPC*8)";
			option21.setAttribute('data-price', 300000)
			option21.text = "300m MPO Cable (MPO- SC/UPC*8)";
			selection.appendChild(option21);

			var option22 = document.createElement("option");
			option22.value = "400m MPO Cable (MPO- SC/UPC*8)";
			option22.setAttribute('data-price', 400000)
			option22.text = "400m MPO Cable (MPO- SC/UPC*8)";
			selection.appendChild(option22);

			var option23 = document.createElement("option");
			option23.value = "500m MPO Cable (MPO- SC/UPC*8)";
			option23.setAttribute('data-price', 500000)
			option23.text = "500m MPO Cable (MPO- SC/UPC*8)";
			selection.appendChild(option23);

			var option24 = document.createElement("option");
			option24.value = "600m MPO Cable (MPO- SC/UPC*8)";
			option24.setAttribute('data-price', 600000)
			option24.text = "600m MPO Cable( MPO- SC/UPC*8)";
			selection.appendChild(option24);

			var option25 = document.createElement("option");
			option25.value = "10m MPO Cable(MPO-MPO)";
			option25.setAttribute('data-price', 10000)
			option25.text = "10m MPO Cable(MPO-MPO)";
			selection.appendChild(option25);

			var option26 = document.createElement("option");
			option26.value = "50m MPO Cable (MPO-MPO)";
			option26.setAttribute('data-price', 50000)
			option26.text = "50m MPO Cable (MPO-MPO)";
			selection.appendChild(option26);

			var option27 = document.createElement("option");
			option27.value = "100m MPO Cable (MPO-MPO)";
			option27.setAttribute('data-price', 100000)
			option27.text = "100m MPO Cable (MPO-MPO)";
			selection.appendChild(option27);

			var option28 = document.createElement("option");
			option28.value = "200m MPO Cable (MPO-MPO)";
			option28.setAttribute('data-price', 200000)
			option28.text = "200m MPO Cable (MPO-MPO)";
			selection.appendChild(option28);

			var option29 = document.createElement("option");
			option29.value = "300m MPO Cable (MPO-MPO)";
			option29.setAttribute('data-price', 300000)
			option29.text = "300m MPO Cable (MPO-MPO)";
			selection.appendChild(option29);

			var option30 = document.createElement("option");
			option30.value = "400m MPO Cable (MPO-MPO)";
			option30.setAttribute('data-price', 400000)
			option30.text = "400m MPO Cable (MPO-MPO)";
			selection.appendChild(option30);

			var option31 = document.createElement("option");
			option31.value = "500m MPO Cable (MPO-MPO)";
			option31.setAttribute('data-price', 500000)
			option31.text = "500m MPO Cable (MPO-MPO)";
			selection.appendChild(option31);

			var option32 = document.createElement("option");
			option32.value = "600m MPO Cable (MPO-MPO)";
			option32.setAttribute('data-price', 600000)
			option32.text = "600m MPO Cable (MPO-MPO)";
			selection.appendChild(option32);

			var option33 = document.createElement("option");
			option33.value = "700m MPO Cable (MPO-MPO)";
			option33.setAttribute('data-price', 700000)
			option33.text = "700m MPO Cable (MPO-MPO)";
			selection.appendChild(option33);

			var option34 = document.createElement("option");
			option34.value = "800m MPO Cable (MPO-MPO)";
			option34.setAttribute('data-price', 800000)
			option34.text = "800m MPO Cable (MPO-MPO)";
			selection.appendChild(option34);

			var option35 = document.createElement("option");
			option35.value = "5m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option35.setAttribute('data-price', 5000)
			option35.text = "5m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option35);

			var option36 = document.createElement("option");
			option36.value = "10m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option36.setAttribute('data-price', 10000)
			option36.text = "10m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option36);

			var option37 = document.createElement("option");
			option37.value = "250m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option37.setAttribute('data-price', 250000)
			option37.text = "250m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option37);

			var option38 = document.createElement("option");
			option38.value = "50m Single-Core Cable( 5mm Round Cable ZTE-ZTE)";
			option38.setAttribute('data-price', 50000)
			option38.text = "50m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option38);

			var option39 = document.createElement("option");
			option39.value = "80m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option39.setAttribute('data-price',80000)
			option39.text = "80m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option39);

			var option40 = document.createElement("option");
			option40.value = "100m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option40.setAttribute('data-price', 100000)
			option40.text = "100m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option40);

			var option41 = document.createElement("option");
			option41.value = "120m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option41.setAttribute('data-price', 120000)
			option41.text = "120m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option41);

			var option42 = document.createElement("option");
			option42.value = "150m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option42.setAttribute('data-price', 150000)
			option42.text = "150m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option42);

			var option43 = document.createElement("option");
			option43.value = "200m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option43.setAttribute('data-price', 200000)
			option43.text = "200m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option41);

			var option44 = document.createElement("option");
			option44.value = "350m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option44.setAttribute('data-price', 350000)
			option44.text = "350m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option44);

			var option45 = document.createElement("option");
			option45.value = "400m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			option45.setAttribute('data-price', 400000)
			option45.text = "400m Single-Core Cable (5mm Round Cable ZTE-ZTE)";
			selection.appendChild(option45);

			var option46 = document.createElement("option");
			option46.value = "Penempatan FO (AE), Including Lashing";
			option46.setAttribute('data-price', 1600)
			option46.text = "Penempatan FO (AE), Including Lashing";
			selection.appendChild(option46);

			var option47 = document.createElement("option");
			option47.value = "Penempatan FO (AE), Including Lashing (48 cores)";
			option47.setAttribute('data-price', 1600)
			option47.text = "Penempatan FO (AE), Including Lashing (48 cores)";
			selection.appendChild(option47);

			var option48 = document.createElement("option");
			option48.value = "Splicing FO Cable";
			option48.setAttribute('data-price', 20000)
			option48.text = "Splicing FO Cable";
			selection.appendChild(option48);

			var option49 = document.createElement("option");
			option49.value = "Test & Comm for Distribution Optical Fiber";
			option49.setAttribute('data-price', 10000)
			option49.text = "Test & Comm for Distribution Optical Fiber";
			selection.appendChild(option49);


			var option50 = document.createElement("option");
			option50.value = "Test & Comm for Feeder Optical Fiber";
			option50.setAttribute('data-price', 10000)
			option50.text = "Test & Comm for Feeder Optical Fiber";
			selection.appendChild(option50);

			var option51 = document.createElement("option");
			option51.value = "Test & Comm for Backbone Optical Fiber";
			option51.setAttribute('data-price', 10000)
			option51.text = "Test & Comm for Backbone Optical Fiber";
			selection.appendChild(option51);
			// Updating the unit price when selecting items
			selection.onchange = function() {
				var selectedOption = this.options[this.selectedIndex]
				var selectedPrice = selectedOption.getAttribute('data-price')
				var unitPriceInput = this.parentNode.parentNode.cells[4].querySelector('input');
				unitPriceInput.value = selectedPrice
				var totalBoqInput = this.parentNode.parentNode.cells[5].querySelector('input')
				var qty = this.parentNode.parentNode.cells[2].querySelector('input')
				var totalActualInput = this.parentNode.parentNode.cells[6].querySelector('input')
				var qtyActual = this.parentNode.parentNode.cells[3].querySelector('input')
				var grandTotalUpdater = document.getElementById('grand-total-payment')
				grandTotalUpdater.addEventListener('change', function(event){
					this.value = unitPriceInput.value * qty
				});
				if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = qtyActual.value * unitPriceInput.value
					}
				if (this.value == "Add Custom Scope Of Work") {
					var customInput = document.createElement("input");
					this.style.display = "none"
					customInput.type = "text"
					customInput.name = "scopeOfWork_" + currentCount.toString()
					applyStyles(customInput, "text")
					this.parentNode.insertBefore(customInput, this.nextSibling);
					
				}
				qty.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * unitPriceInput.value
					
					updateTotals();
					termsAmountCalculation();
					taxAmountCalculation();
					updateGrandTotal();
				});
				unitPriceInput.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * qty.value
					
					updateTotals();
					termsAmountCalculation();
					taxAmountCalculation();
					updateGrandTotal();
				});
				totalBoqInput.value = unitPriceInput.value * qty.value;

				// Total Actual
				qtyActual.addEventListener('input', function(event) {
					if (this.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * unitPriceInput.value
						
						updateTotals();
						termsAmountCalculation();
						taxAmountCalculation();
						updateGrandTotal();
					}
				});
				unitPriceInput.addEventListener('input', function(event) {
					if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * qtyActual.value
						
						updateTotals();
						termsAmountCalculation();
						taxAmountCalculation();
						updateGrandTotal();
					}
				});
			};
			cell.appendChild(selection);
		}
		if (i == 1 && pricingType == 'internal'  && woProject =='EMR') {
			var selection = document.createElement("select");
			selection.name = "scopeOfWork_" + currentCount.toString()
			cell.style.textAlign = "left";
			selection.class = "line-items-container"
			// Add options to the sele5t element
			var option1 = document.createElement("option");
			option1.value = "Pulling Cable-24 core (AE) include install the Accessory";
			option1.setAttribute('data-price', 1600)
			option1.text = "Pulling Cable-24 core (AE) include install the Accessory";
			selection.appendChild(option1);

			var option2 = document.createElement("option");
			option2.value = "Pulling Cable-48 core (AE) include install the Accessory";
			option2.setAttribute('data-price', 1600)
			option2.text = "Pulling Cable-48 core (AE) include install the Accessory";
			selection.appendChild(option2);

			var option3 = document.createElement("option");
			option3.value = "Pulling Cable-96 core (AE) include install the Accessory";
			option3.setAttribute('data-price', 1600)
			option3.text = "Pulling Cable-96 core (AE) include install the Accessory";
			selection.appendChild(option3);

			var option4 = document.createElement("option");
			option4.value = "Pulling Cable-144 core (AE) include install the Accessory";
			option4.setAttribute('data-price', 2000)
			option4.text = "Pulling Cable-144 core (AE) include install the Accessory";
			selection.appendChild(option4);

			var option5 = document.createElement("option");
			option5.value = "Instal Label Cable (on pole, in Handhole)";
			option5.setAttribute('data-price', 2000)
			option5.text = "Instal Label Cable (on pole, in Handhole)";
			selection.appendChild(option5);

			var option6 = document.createElement("option");
			option6.value = "Instal Label FDT";
			option6.setAttribute('data-price', 2000)
			option6.text = "Instal Label FDT";
			selection.appendChild(option6);

			var option7 = document.createElement("option");
			option7.value = "Instal Label FAT";
			option7.setAttribute('data-price', 2000)
			option7.text = "Instal Label FAT";
			selection.appendChild(option7);

			var option8 = document.createElement("option");
			option8.value = "Instal Label Pole";
			option8.setAttribute('data-price', 2000)
			option8.text = "Instal Label Pole";
			selection.appendChild(option8);

			var option9 = document.createElement("option");
			option9.value = "Instal pole 7 & 9 meter 4 inch include the foundation";
			option9.setAttribute('data-price', 110000)
			option9.text = "Instal pole 7 & 9 meter 4 inch include the foundation";
			selection.appendChild(option9);

			var option10 = document.createElement("option");
			option10.value = "Instal pole 7 meter 3 inch include the foundation";
			option10.setAttribute('data-price', 110000)
			option10.text = "Instal pole 7 meter 3 inch include the foundation";
			selection.appendChild(option10);

			var option11 = document.createElement("option");
			option11.value = "Instal Cable Hanger";
			option11.setAttribute('data-price', 20000)
			option11.text = "Instal Cable Hanger";
			selection.appendChild(option11);

			var option12 = document.createElement("option");
			option12.value = "Instal Sling Wire";
			option12.setAttribute('data-price', 1600)
			option12.text = "Instal Sling Wire";
			selection.appendChild(option12);

			var option13 = document.createElement("option");
			option13.value = "Instal FDT";
			option13.setAttribute('data-price', 120000)
			option13.text = "Instal FDT";
			selection.appendChild(option13);

			var option14 = document.createElement("option");
			option14.value = "Instal FAT include the Splicing & Splitter";
			option14.setAttribute('data-price', 130000)
			option14.text = "Instal FAT include the Splicing & Splitter";
			selection.appendChild(option14);

			var option15 = document.createElement("option");
			option15.value = "Splicing FDT / JC";
			option15.setAttribute('data-price', 20000)
			option15.text = "Splicing FDT / JC";
			selection.appendChild(option15);

			// User create custom object 
			var option16 = document.createElement("option");
			option16.value = "Add Custom Scope Of Work";
			option16.text = "Add Custom Scope Of Work"
			selection.appendChild(option16)
			// Updating the unit price when selecting items
			selection.onchange = function() {
				var selectedOption = this.options[this.selectedIndex]
				var selectedPrice = selectedOption.getAttribute('data-price')
				var unitPriceInput = this.parentNode.parentNode.cells[4].querySelector('input');
				unitPriceInput.value = selectedPrice
				var totalBoqInput = this.parentNode.parentNode.cells[5].querySelector('input')
				var qty = this.parentNode.parentNode.cells[2].querySelector('input')
				var totalActualInput = this.parentNode.parentNode.cells[6].querySelector('input')
				var qtyActual = this.parentNode.parentNode.cells[3].querySelector('input')
				var grandTotalUpdater = document.getElementById('grand-total-payment')
				grandTotalUpdater.addEventListener('change', function(event){
					this.value = unitPriceInput.value * qty
				});
				if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = qtyActual.value * unitPriceInput.value
					}
				if (this.value == "Add Custom Scope Of Work") {
					var customInput = document.createElement("input");
					this.style.display = "none"
					customInput.type = "text"
					customInput.name = "scopeOfWork_" + currentCount.toString()
					applyStyles(customInput, "text")
					this.parentNode.insertBefore(customInput, this.nextSibling);
					
				}
				qty.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * unitPriceInput.value
				});
				unitPriceInput.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * qty.value
				});
				totalBoqInput.value = unitPriceInput.value * qty.value;

				// Total Actual
				qtyActual.addEventListener('input', function(event) {
					if (this.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * unitPriceInput.value
					}
				});
				unitPriceInput.addEventListener('input', function(event) {
					if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * qtyActual.value
					}
				});
			};
			cell.appendChild(selection);
		}
		if (i == 1 && pricingType == 'traditional' && woProject =='EMR') {
			var selection = document.createElement("select");
			selection.name = "scopeOfWork_" + currentCount.toString()
			cell.style.textAlign = "left";
			selection.class = "line-items-container"
			// Add options to the sele5t element
			var option1 = document.createElement("option");
			option1.value = "Pulling Cable-24 core (AE) include install the Accessory";
			option1.setAttribute('data-price', 2500)
			option1.text = "Pulling Cable-24 core (AE) include install the Accessory";
			selection.appendChild(option1);

			var option2 = document.createElement("option");
			option2.value = "Pulling Cable-48 core (AE) include install the Accessory";
			option2.setAttribute('data-price', 2500)
			option2.text = "Pulling Cable-48 core (AE) include install the Accessory";
			selection.appendChild(option2);

			var option3 = document.createElement("option");
			option3.value = "Pulling Cable-96 core (AE) include install the Accessory";
			option3.setAttribute('data-price', 2500)
			option3.text = "Pulling Cable-96 core (AE) include install the Accessory";
			selection.appendChild(option3);

			var option4 = document.createElement("option");
			option4.value = "Pulling Cable-144 core (AE) include install the Accessory";
			option4.setAttribute('data-price', 3000)
			option4.text = "Pulling Cable-144 core (AE) include install the Accessory";
			selection.appendChild(option4);

			var option5 = document.createElement("option");
			option5.value = "Instal Label Cable (on pole, in Handhole)";
			option5.setAttribute('data-price', 2000)
			option5.text = "Instal Label Cable (on pole, in Handhole)";
			selection.appendChild(option5);

			var option6 = document.createElement("option");
			option6.value = "Instal Label FDT";
			option6.setAttribute('data-price', 2000)
			option6.text = "Instal Label FDT";
			selection.appendChild(option6);

			var option7 = document.createElement("option");
			option7.value = "Instal Label FAT";
			option7.setAttribute('data-price', 2000)
			option7.text = "Instal Label FAT";
			selection.appendChild(option7);

			var option8 = document.createElement("option");
			option8.value = "Instal Label Pole";
			option8.setAttribute('data-price', 2000)
			option8.text = "Instal Label Pole";
			selection.appendChild(option8);

			var option9 = document.createElement("option");
			option9.value = "Instal pole 7 & 9 meter 4 inch include the foundation";
			option9.setAttribute('data-price', 135000)
			option9.text = "Instal pole 7 & 9 meter 4 inch include the foundation";
			selection.appendChild(option9);

			var option10 = document.createElement("option");
			option10.value = "Instal pole 7 meter 3 inch include the foundation";
			option10.setAttribute('data-price', 130000)
			option10.text = "Instal pole 7 meter 3 inch include the foundation";
			selection.appendChild(option10);

			var option11 = document.createElement("option");
			option11.value = "Instal Cable Hanger";
			option11.setAttribute('data-price', 20000)
			option11.text = "Instal Cable Hanger";
			selection.appendChild(option11);

			var option12 = document.createElement("option");
			option12.value = "Instal Sling Wire";
			option12.setAttribute('data-price', 2500)
			option12.text = "Instal Sling Wire";
			selection.appendChild(option12);

			var option13 = document.createElement("option");
			option13.value = "Instal FDT";
			option13.setAttribute('data-price', 130000)
			option13.text = "Instal FDT";
			selection.appendChild(option13);

			var option14 = document.createElement("option");
			option14.value = "Instal FAT include the Splicing & Splitter";
			option14.setAttribute('data-price', 150000)
			option14.text = "Instal FAT include the Splicing & Splitter";
			selection.appendChild(option14);

			var option15 = document.createElement("option");
			option15.value = "Splicing FDT / JC";
			option15.setAttribute('data-price', 20000)
			option15.text = "Splicing FDT / JC";
			selection.appendChild(option15);

			// User create custom object 
			var option16 = document.createElement("option");
			option16.value = "Add Custom Scope Of Work";
			option16.text = "Add Custom Scope Of Work"
			selection.appendChild(option16)
			// Updating the unit price when selecting items
			selection.onchange = function() {
				var selectedOption = this.options[this.selectedIndex]
				var selectedPrice = selectedOption.getAttribute('data-price')
				var unitPriceInput = this.parentNode.parentNode.cells[4].querySelector('input');
				unitPriceInput.value = selectedPrice
				var totalBoqInput = this.parentNode.parentNode.cells[5].querySelector('input')
				var qty = this.parentNode.parentNode.cells[2].querySelector('input')
				var totalActualInput = this.parentNode.parentNode.cells[6].querySelector('input')
				var qtyActual = this.parentNode.parentNode.cells[3].querySelector('input')
				var grandTotalUpdater = document.getElementById('grand-total-payment')
				grandTotalUpdater.addEventListener('change', function(event){
					this.value = unitPriceInput.value * qty
				});
				if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = qtyActual.value * unitPriceInput.value
					}
				if (this.value == "Add Custom Scope Of Work") {
					var customInput = document.createElement("input");
					this.style.display = "none"
					customInput.type = "text"
					customInput.name = "scopeOfWork_" + currentCount.toString()
					applyStyles(customInput, "text")
					this.parentNode.insertBefore(customInput, this.nextSibling);
					
				}
				qty.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * unitPriceInput.value
				});
				unitPriceInput.addEventListener('input', function(event) {
					totalBoqInput.value = this.value * qty.value
				});
				totalBoqInput.value = unitPriceInput.value * qty.value;

				// Total Actual
				qtyActual.addEventListener('input', function(event) {
					if (this.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * unitPriceInput.value
					}
				});
				unitPriceInput.addEventListener('input', function(event) {
					if (qtyActual.value == 0){
						totalActualInput.value = ''
					}
					else {
						totalActualInput.value = this.value * qtyActual.value
					}
				});
			};
			cell.appendChild(selection);
		}

		if (i == 2) {
			var num = document.createElement("input");
			num.name = "qtyB_" + currentCount.toString()
			num.type = "number";
			num.class = "line-items-container"

			cell.appendChild(num);
		}
		if (i == 3) {
			var num1 = document.createElement("input");
			num1.name = "qtyA_" + currentCount.toString()
			num1.type = "number";
			num1.class = "line-items-container"


			cell.appendChild(num1)
		}
		if (i == 4) { // Assuming first cell is for the row number or another widget
			var text = document.createElement("input");
			text.name = "unitPrice_" + currentCount.toString()
			text.class = "line-items-container"

			cell.appendChild(text);
		}
		if (i == 5) { // Assuming first cell is for the row number or another widget
			var text3 = document.createElement("input");
			text3.name = "totalB_" + currentCount.toString()
			text3.class = "line-items-container"

			cell.appendChild(text3);
		}
		if (i == 6) { // Assuming first cell is for the row number or another widget
			var text2 = document.createElement("input");
			text2.name = "totalA_" + currentCount.toString()
			text2.class = "line-items-container"

			cell.appendChild(text2);
		}
		if (i == 7) { // Assuming first cell is for the row number or another widget
			var text4 = document.createElement("input");
			text4.name = "remarks_" + currentCount.toString()
			text4.class = "line-items-container"
			cell.style.textAlign = "left"; // This will align the text inside the input
			cell.appendChild(text4);
		}
		if (i == 8){
			var removeButton = document.createElement("button");
			removeButton.id = "removeRow"
			removeButton.className = "button add-new-button removeRowButton"
			removeButton.class = "line-items-container"
			removeButton.textContent = "-"
			cell.appendChild(removeButton)
		}
	}
}
function applyStyles(element, type) {
	element.style.width = "100%"; // Make element take the full width of the cell
	element.style.height = "30px"; // Set a fixed height for a tighter look
	element.style.boxSizing = "border-box"; // Include padding and border in the width and height
	element.style.border = "1px solid #ddd"; // Uniform border style
	element.style.padding = "4px"; // Consistent padding
	element.style.margin = "0"; // Remove margins to avoid unnecessary spacing
}
// CHANGING THE TERMS SELECTION CELL


document.getElementById('terms-selection').onchange = function(){
  if (this.value == "CREATE") {
    var customInput = document.createElement("input");
    customInput.type = "text";
    customInput.name = "terms-selection"; // Using the same name for consistency
    customInput.id = "terms-selection"; // Giving an ID for easier access
	customInput.textContent = ''

    // Hide the dropdown
    this.style.display = "none";

    // Insert the new input field after the dropdown
    this.parentNode.insertBefore(customInput, this.nextSibling);
	}
  var percentageAmount = this.options[this.selectedIndex].getAttribute('data-percentage-amount');
  var thisRemarks = this.options[this.selectedIndex].getAttribute('data-remarks');

  document.getElementsByName('terms-percentage-cell')[0].value = percentageAmount;
  document.getElementsByName('payment-remarks-cell')[0].value = thisRemarks;  
}

document.getElementById('bank').onchange = function() {
  if (this.value == "CREATE") {
    var customInput = document.createElement("input");
    customInput.type = "text";
    customInput.name = "bank";
    customInput.id = "bank"; // Use a different ID to avoid conflicts

    // Add the uppercase listener to the new input
    addUppercaseListener(customInput);

    this.style.display = "none";
    this.parentNode.insertBefore(customInput, this.nextSibling);
  }
};

document.getElementById('customer').onchange = function() {
  if (this.value == "CREATE") {
    var customInput = document.createElement("input");
    customInput.type = "text";
    customInput.name = "customer";
    customInput.id = "customer"; // Use a different ID to avoid conflicts

    // Add the uppercase listener to the new input
    addUppercaseListener(customInput);

    this.style.display = "none";
    this.parentNode.insertBefore(customInput, this.nextSibling);
  }
};

document.getElementById('region').onchange = function() {
  if (this.value == "CREATE") {
    var customInput = document.createElement("input");
    customInput.type = "text";
    customInput.name = "region";
    customInput.id = "region"; // Use a different ID to avoid conflicts

    // Add the uppercase listener to the new input
    addUppercaseListener(customInput);

    this.style.display = "none";
    this.parentNode.insertBefore(customInput, this.nextSibling);
  }
};

// CHANGING THE TAX SELECTION CELL
document.getElementById('tax-cell').onchange = function(){
  var percentageAmount = this.options[this.selectedIndex].getAttribute('data-tax-percentage-amount');
  document.getElementsByName('tax-percentage-cell')[0].value = percentageAmount;
}

document.addEventListener('input', function(event) {
	updateTotals()
	termsAmountCalculation()
	taxAmountCalculation()
	updateGrandTotal()

});
document.addEventListener('change', function(event) {
	updateTotals()
	termsAmountCalculation()
	taxAmountCalculation()
	updateGrandTotal()
});


// REMOVE BUTTON ON SCOPE OF WORK
document.addEventListener('DOMContentLoaded', (event) => {
    document.getElementById('scopeOfWork').addEventListener('click', function(event) {
        if (event.target && event.target.className.includes('removeRowButton')) {
        var row = event.target.closest('tr');
            if (row) {
                row.remove(); // Remove the row
                reIndexRows('scopeOfWork'); // Re-index rows after removal
                number_of_scopes = document.getElementById('number_of_scopes')
                number_of_scopes.value -= 1
                updateTotals()
                termsAmountCalculation()
                taxAmountCalculation()
                updateGrandTotal()
            }
        }
    });
});

// REMOVE BUTTON ON DEDUCTION
document.addEventListener('DOMContentLoaded', (event) => {
	// Event delegation
    document.getElementById('payment-table').addEventListener('click', function(event) {
        if (event.target && event.target.className.includes('removeRowDed')) {
        var row = event.target.closest('tr');
            if (row) {
                row.remove(); // Remove the row
                reIndexRowsDed('deduction-row'); // Re-index rows after removal
                number_of_deduction = document.getElementById('number_of_deduction')
                number_of_deduction.value -= 1
                number_of_deduction.dataset.initialValue = number_of_deduction.value 
                updateTotals()
                termsAmountCalculation()
                taxAmountCalculation()
                updateGrandTotal()
            }
        }
    });
});

// REMOVE BUTTON ON PAYMENT TABLE
document.addEventListener('DOMContentLoaded', (event) => {
	// Event delegation
    document.getElementById('paymentTable').addEventListener('click', function(event) {
        if (event.target && event.target.className.includes('removeRowPayment')) {
        var row = event.target.closest('tr');
            if (row) {
                row.remove(); // Remove the row
                reIndexRowsPayment('paymentTable'); // Re-index rows after removal
                number_of_payment = document.getElementById('number_of_payment')
                number_of_payment.value -= 1
            }
        }
    });
});



document.getElementById('wo_date').addEventListener('input', function () {
// Extract the year and month from the date
var date = this.value;
var yearMonth = date ? date.substr(2, 2) + date.substr(5, 2) : '';

// Set the YYMM format to the 'shortdate' input field
document.getElementById('shortdate').value = yearMonth;
});
document.getElementById('wo_number').addEventListener('input', function () {
// Check if the input is not more than 4 digits and if it is within the 0-9999 range
if (this.value.length > 4 || parseInt(this.value, 10) > 9999) {
this.value = this.value.slice(0, 4); // Limit to the first 4 digits
}
});
document.getElementsByName('request_by')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});
document.getElementsByName('city')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('account_name')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('category')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('project')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('account_number')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('phone_number')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('npwp')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('clusterName')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});document.getElementsByName('siteId')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});
document.getElementsByName('hp')[0].addEventListener('input', function () {
this.value = this.value.toUpperCase();
});
</script>

{% endblock %}
